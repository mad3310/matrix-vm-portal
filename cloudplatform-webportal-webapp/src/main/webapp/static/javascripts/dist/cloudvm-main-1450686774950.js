function ClientInfor(){this.engine={ie:0,gecko:0,webkit:0,khtml:0,opera:0,ver:null},this.browser={ie:0,firefox:0,safari:0,konq:0,opera:0,chrome:0,ver:null},this.system={win:!1,mac:!1,xll:!1,iphone:!1,ipod:!1,ipad:!1,ios:!1,android:!1,nokiaN:!1,winMobile:!1,wii:!1,ps:!1},this.ua=window.navigator.userAgent,this.p=window.navigator.platform,this.getSystemInfor=function(){if(this.system.win=0==this.p.indexOf("Win"),this.system.mac=0==this.p.indexOf("Mac"),this.system.xll=0==this.p.indexOf("Linux")||0==this.p.indexOf("Xll"),this.system.iphone=this.ua.indexOf("iPhone")>-1,this.system.ipod=this.ua.indexOf("iPod")>-1,this.system.ipad=this.ua.indexOf("iPad")>-1,this.system.mac&&this.ua.indexOf("Mobile")>-1&&(/CPU (?:iPhone )?OS (\d+_\d+)/.test(this.ua)?this.system.ios=parseFloat(RegExp.$1.replace("_",".")):this.system.ios=2),/Android (\d+\.\d+)/.test(this.ua)&&(this.system.android=parseFloat(RegExp.$1)),this.system.nokiaN=this.ua.indexOf("NokiaN")>-1,"CE"==this.system.win?this.system.winMobile=this.system.win:"Ph"==this.system.win&&/Windows Phone OS (\d+.\d+)/.test(this.ua)&&(this.system.win="Phone",this.system.winMobile=parseFloat(RegExp.$1)),this.system.wii=this.ua.indexOf("Wii")>-1,this.system.ps=/playstation/i.test(this.ua),this.system.win&&/Win(?:dows )?([^do]{2})\s?(\d+\.\d+)?/.test(this.ua))if("NT"==RegExp.$1)switch(RegExp.$2){case"5.0":this.system.win="2000";break;case"5.1":this.system.win="XP";break;case"6.0":this.system.win="Vista";break;case"6.1":this.system.win="7";break;case"6.2":this.system.win="8";break;default:this.system.win="NT"}else"9x"==RegExp.$1?this.system.win="ME":this.system.win=RegExp.$1;return this.system},this.getBrowserInfor=function(){if(window.opera)this.engine.ver=this.browser.ver=window.opera.version(),this.engine.opera=this.browser.opera=parseFloat(this.engine.ver);else if(/AppleWebKit\/(\S+)/i.test(this.ua))if(this.engine.ver=this.browser.ver=RegExp.$1,this.engine.webkit=parseFloat(this.engine.ver),/Chrome\/(\S+)/i.test(this.ua))this.browser.chrome=parseFloat(this.engine.ver);else if(/Version\/(\S+)/i.test(this.ua))this.browser.safari=parseFloat(this.engine.ver);else{var e=1;e=this.engine.webkit<100?1:this.engine.webkit<312?1.2:this.engine.webkit<412?1.3:2,this.browser.safari=this.browser.ver=e}else/KHTML\/(\S+)/i.test(this.ua)||/Konqueror\/([^;]+)/i.test(this.ua)?(this.engine.ver=this.browser.ver=RegExp.$1,this.engine.khtml=this.browser.konq=parseFloat(this.engine.ver)):/rv:([^\)]+)\) Gecko\/\d{8}/i.test(this.ua)?(this.engine.ver=RegExp.$1,this.engine.gecko=parseFloat(this.engine.ver),/Firefox\/(\S+)/i.test(this.ua)&&(this.browser.ver=RegExp.$1,this.browser.firefox=parseFloat(this.browser.ver))):/MSIE\s([^;]+)/i.test(this.ua)?(this.engine.ver=this.browser.ver=RegExp.$1,this.engine.ie=this.browser.ie=parseFloat(this.engine.ver)):/trident.*rv:([^)]+)/i.test(this.ua)&&(this.engine.ver=this.browser.ver=RegExp.$1,this.engine.ie=this.browser.ie=parseFloat(this.engine.ver));return this.browser},this.getEngineInfor=function(){if(window.opera)this.engine.ver=this.browser.ver=window.opera.version(),this.engine.opera=this.browser.opera=parseFloat(this.engine.ver);else if(/AppleWebKit\/(\S+)/i.test(this.ua))if(this.engine.ver=this.browser.ver=RegExp.$1,this.engine.webkit=parseFloat(this.engine.ver),/Chrome\/(\S+)/i.test(this.ua))this.browser.chrome=parseFloat(this.engine.ver);else if(/Version\/(\S+)/i.test(this.ua))this.browser.safari=parseFloat(this.engine.ver);else{var e=1;e=this.engine.webkit<100?1:this.engine.webkit<312?1.2:this.engine.webkit<412?1.3:2,this.browser.safari=this.browser.ver=e}else/KHTML\/(\S+)/i.test(this.ua)||/Konqueror\/([^;]+)/i.test(this.ua)?(this.engine.ver=this.browser.ver=RegExp.$1,this.engine.khtml=this.browser.konq=parseFloat(this.engine.ver)):/rv:([^\)]+)\) Gecko\/\d{8}/i.test(this.ua)?(this.engine.ver=RegExp.$1,this.engine.gecko=parseFloat(this.engine.ver),/Firefox\/(\S+)/i.test(this.ua)&&(this.browser.ver=RegExp.$1,this.browser.firefox=parseFloat(this.browser.ver))):/MSIE\s([^;]+)/i.test(this.ua)?(this.engine.ver=this.browser.ver=RegExp.$1,this.engine.ie=this.browser.ie=parseFloat(this.engine.ver)):/trident.*rv:([^)]+)/i.test(this.ua)&&(this.engine.ver=this.browser.ver=RegExp.$1,this.engine.ie=this.browser.ie=parseFloat(this.engine.ver));return this.engine}}define("browserCheck",["jquery"],function(e){return function(){var t;return t||e.browserCheck}}(this)),define("common",["jquery","browserCheck"],function(e){function t(e){var t=e.getBrowserInfor();t.ie&&t.ver<9?window.location.replace="/browserError":t.firefox&&t.ver<5?window.location.replace="/browserError":t.chrome&&t.ver<7?window.location.replace="/browserError":t.safari&&t.ver<4&&(window.location.replace="/browserError")}function n(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var i=t[n].split("=");if(i[0]==e)return i[1]}return""}var i=new ClientInfor;t(i);var r=e(window).height()-70;e(".content").css("min-height",r);for(var o=[{url:"/profile/#/dashboard",title:"概览",icon:"iconfont icon-clouddashboard",isSubmenuFisrt:!0},{url:"/cvm/#/vm",title:"云主机",icon:"iconfont icon-cloudhost",isSubmenuFisrt:!0},{url:"/cvm/#/vm-disk",title:"云硬盘",icon:"iconfont icon-clouddisk"},{url:"/cvm/#/vm-vpc",title:"私有网络",icon:"iconfont icon-cloudnet"},{url:"/cvm/#/vm-floatIP",title:"公网IP",icon:"iconfont icon-cloudfloatip"},{url:"/cvm/#/vm-router",title:"路由器",icon:"iconfont icon-cloudroute"},{url:"/cvm/#/vm-snapshot",title:"快照",icon:"iconfont icon-cloudsnap"},{url:"/cvm/#/vm-image",title:"镜像",icon:"iconfont icon-cloudimage"},{url:"/cvm/#/vm-keypair",title:"密钥",icon:"iconfont icon-cloudkeypair"}],a=null,s=[],c=e(".side-menu"),l=window.location.pathname,u=window.location.hash,d=l+u,m=function(e){var t=!1;return t=u?o[f].url===d:e.url.indexOf(l)>-1&&e.isSubmenuFisrt},f=0,p=o.length;p>f;f++)a='<li class="menu-item'+(m(o[f])?" active":"")+'"><a href="'+o[f].url+'"><i class="'+o[f].icon+'"></i><span>'+o[f].title+"</span></a></li>",s.push(a);c.html(s.join("")),c.on("click",".menu-item a",function(t){c.children(".menu-item").removeClass("active"),e(t.target).closest("li").addClass("active")}),e(".header-username").text(n("userName"));var v=n("headPortrait");if(v)e(".account-icon").attr("src",v);else{var g=n("userId"),h="/user/"+g;e.ajax({url:h,type:"get",success:function(t){if(0==t.result);else{var n=t.data;n&&n.userAvatar&&e(".account-icon").attr("src",n.userAvatar)}}})}return{}}),define("controllers/app.controller",["angular"],function(e){return e.module("app.controller",[])}),define("controllers/VirtualMachine",["controllers/app.controller"],function(e){e.controller("VirtualMachineCrtl",["$scope","$interval","$window","$q","$modal","Config","Utility","HttpService","WidgetService","CurrentContext",function(e,t,n,i,r,o,a,s,c,l){e.searchVmName="",e.vmTaskStatuses=o.vmTaskStatuses,e.vmList=[],e.currentPage=1,e.totalItems=0,e.pageSize=10,e.operationBtn={};var u=[];e.onPageChange=function(){d()},e.doSearch=function(){d()},e.startVm=function(e){var t=m(),n="",i="";if(1!==t.length)return void c.notifyWarning("请选中一个云主机");if(n=t[0].vmState,i=t[0].taskState,i||"stopped"!==n)return void c.notifyWarning("云主机当前状态不可启动");var r={vmId:t[0].id},a=c.openConfirmModal("启动云主机","确定要云主机（"+t[0].name+"）启动吗？");a.result.then(function(e){return e?(c.notifyInfo("启动云主机执行中...."),t[0].vmState=null,t[0].taskState="starting",void s.doPost(o.urls.vm_start.replace("{region}",l.regionId),r).success(function(e,r,o,s){1===e.result?(t[0].vmState="active",t[0].taskState=null,a.close(e),c.notifySuccess("启动云主机成功"),d()):(t[0].vmState=n,t[0].taskState=i,c.notifyError(e.msgs[0]||"启动云主机失败"))})):e},function(){})},e.stopVm=function(e){var t=m(),n="",i="";if(1!==t.length)return void c.notifyWarning("请选中一个云主机");if(n=t[0].vmState,i=t[0].taskState,i||"active"!==n)return void c.notifyWarning("云主机当前状态不可关机");var r={vmId:t[0].id},a=c.openConfirmModal("云主机关机","确定要云主机（"+t[0].name+"）关机吗？");a.result.then(function(e){return e?(c.notifyInfo("关机云主机执行中..."),t[0].vmState=null,t[0].taskState="stopping",void s.doPost(o.urls.vm_stop.replace("{region}",l.regionId),r).success(function(e,r,o,s){1===e.result?(t[0].vmState="stopped",t[0].taskState=null,a.close(e),c.notifySuccess("关机云主机成功"),d()):(t[0].vmState=n,t[0].taskState=i,c.notifyError(e.msgs[0]||"关机云主机失败"))})):e},function(){})},e.deleteVm=function(e){var t=m(),n="",i="";if(1!==t.length)return void c.notifyWarning("请选中一个云主机");if(n=t[0].vmState,i=t[0].taskState,i||"active"!==n&&"stopped"!==n&&"error"!=n)return void c.notifyWarning("云主机当前状态不可删除");var r={vmId:t[0].id},a=c.openConfirmModal("删除云主机","确定要删除云主机（"+t[0].name+"）吗？");a.result.then(function(e){return e?(c.notifyInfo("删除云主机执行中..."),t[0].vmState=null,t[0].taskState="deleting",void s.doPost(o.urls.vm_delete.replace("{region}",t[0].region),r).success(function(e,r,o,s){1===e.result?(t[0].vmState="deleted",t[0].taskState=null,a.close(e),c.notifySuccess("删除云主机成功"),d()):(t[0].vmState=n,t[0].taskState=i,c.notifyError(e.msgs[0]||"删除云主机失败"))})):e},function(){})},e.rebootVm=function(e){var t=m(),n="",i="";if(1!==t.length)return void c.notifyWarning("请选中一个云主机");if(n=t[0].vmState,i=t[0].taskState,i||"active"!==n)return void c.notifyWarning("云主机当前状态不可重启");var r={vmId:t[0].id,region:t[0].region},a=c.openConfirmModal("重启云主机","确定要重启云主机（"+t[0].name+"）吗？");a.result.then(function(e){return e?(c.notifyInfo("重启云主机执行中...."),t[0].vmState=null,t[0].taskState="rebooting",void s.doPost(o.urls.vm_reboot,r).success(function(e,r,o,s){1===e.result?(a.close(e),t[0].vmState="active",t[0].taskState=null,c.notifySuccess("重启云主机成功"),d()):(t[0].vmState=n,t[0].taskState=i,c.notifyError(e.msgs[0]||"重启云主机失败"))})):e},function(){})},e.isAllVmChecked=function(){var t=e.vmList.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllVm=function(){e.isAllVmChecked()?e.vmList.forEach(function(e){e.checked=!1}):e.vmList.forEach(function(e){e.checked=!0})},e.checkVm=function(e,t){e.checked=e.checked===!0?!1:!0},e.openDiskEditModal=function(t){var n=m();if(1!==n.length)return void c.notifyWarning("请选中一个云主机");var i=r.open({animation:e.animationsEnabled,templateUrl:"VmEditModalTpl",controller:"VmEditModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return l.regionId},vm:function(){return n[0]}}});i.result.then(function(e){e&&1===e.result&&d()},function(){})},e.openDiskAttachModal=function(t){var n=m();if(1!==n.length)return void c.notifyWarning("请选中一个云主机");if(n[0].taskState||"active"!==n[0].vmState&&"stopped"!==n[0].vmState)return void c.notifyWarning("云主机当前状态不可挂载云硬盘");var i=r.open({animation:e.animationsEnabled,templateUrl:"DiskAttachModalTpl",controller:"DiskAttachModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return l.regionId},vm:function(){return n[0]}}});i.result.then(function(e){e&&1===e.result&&d()},function(){})},e.openDiskDetachModal=function(t){var n=m();if(1!==n.length)return void c.notifyWarning("请选中一个云主机");if(n[0].taskState||"active"!==n[0].vmState&&"stopped"!==n[0].vmState)return void c.notifyWarning("云主机当前状态不可卸载云硬盘");if(!n[0].volumes||!n[0].volumes.length)return void c.notifyWarning("云主机未绑定云硬盘");var i=r.open({animation:e.animationsEnabled,templateUrl:"DiskDetachModalTpl",controller:"DiskDetachModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return l.regionId},vm:function(){return n[0]}}});i.result.then(function(e){e&&1===e.result&&d()},function(){})},e.openFloatingIpBindModal=function(t){var n=m();if(1!==n.length)return void c.notifyWarning("请选中一个云主机");if(n[0].taskState||"active"!==n[0].vmState&&"stopped"!==n[0].vmState)return void c.notifyWarning("云主机当前状态不可绑定公网IP");var i=r.open({animation:e.animationsEnabled,templateUrl:"FloatingIpBindModalTpl",controller:"FloatingIpBindModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return l.regionId},vm:function(){return n[0]}}});i.result.then(function(e){e&&1===e.result&&d()},function(){})},e.openVmCreateModal=function(t){var n=r.open({animation:e.animationsEnabled,templateUrl:"/static/apps/cloudvm/templates/vm-create-modal.html",controller:"VmCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return l.regionId},vmSnapshot:function(){return void 0},loadAllRegionData:function(){if(l.allRegionData)return!0;var e=i.defer();return s.doGet(o.urls.region_list).then(function(t,n,i,r){l.allRegionData=t.data,e.resolve(!0)}),e.promise}}});n.result.then(function(e){e&&1===e.result&&d()},function(){})},e.openVmSnapshotCreateModal=function(t){var n=m();if(1!==n.length)return void c.notifyWarning("请选中一个云主机");if(n[0].taskState||"active"!==n[0].vmState&&"stopped"!==n[0].vmState)return void c.notifyWarning("云主机当前状态不可创建快照");var i=r.open({animation:e.animationsEnabled,templateUrl:"VmSnapshotCreateModalTpl",controller:"VmSnapshotCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return l.regionId},vm:function(){return n[0]}}});i.result.then(function(e){e&&1===e.result},function(){})},e.openVmPasswordChangeModal=function(t){var n=m();if(1!==n.length)return void c.notifyWarning("请选中一个云主机");if(n[0].taskState||"active"!==n[0].vmState)return void c.notifyWarning("云主机当前状态不可修改密码");var i=r.open({animation:e.animationsEnabled,templateUrl:"VmPasswordChangeModalTpl",controller:"VmPasswordChangeModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return l.regionId},vm:function(){return n[0]}}});i.result.then(function(e){e&&1===e.result},function(){})},e.navigateToVNC=function(e){return e.taskState||"active"!==e.vmState?void c.notifyWarning("云主机当前状态不可启动VNC"):void s.doPost(o.urls.vm_vnc.replace("{region}",l.regionId),{vmId:e.id}).success(function(e,t,i,r){1===e.result?n.open(e.data):c.notifyError(e.msgs[0]||"获取云主机VNC连接失败")})};var d=function(){u=[];var n={name:e.searchVmName,currentPage:e.currentPage,recordsPerPage:e.pageSize};e.isListLoading=!0,s.doGet(o.urls.vm_list.replace("{region}",l.regionId),n).then(function(n,i,r,u){a.isServiceReady("serviceStatus2")||c.notifyWarning("服务未完全创建，请刷新试试看！"),e.isListLoading=!1,e.vmList=n.data.data,e.totalItems=n.data.totalRecords,e.vmList.filter(function(e){return!f(e)}).forEach(function(e){var n=o.urls.vm_detail.replace("{region}",l.regionId).replace("{vmId}",e.id),i=t(function(){s.doGet(n).then(function(n){f(n.data)&&(e.vmState=n.data.vmState,e.taskState=n.data.taskState,t.cancel(i),d())})},5e3)})})},m=function(){return e.vmList.filter(function(e){return e.checked===!0})},f=function(e){return!("building"===e.vmState||e.taskState||e.volumes&&e.volumes.length&&e.volumes.filter(function(e){return"attaching"===e.status}).length)},p=function(){var t={type:"virtualMachine",state:"vmState",other:["volumes","ipAddresses.public"],operations:["create","start","stop","delete","restart","createsnap","attachdisk","detachdisk","bindfloatIp","editpass"]};e.$watch(function(){return e.vmList.map(function(e){return e.checked}).join(";")},function(){var n=a.setOperationBtns(e,e.vmList,t,u,o),i=t.operations;for(var r in i)e.operationBtn[i[r]]=n[r]})};d(),p()}]),e.controller("DiskAttachModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","vm",function(e,t,n,i,r,o,a,s,c){o.diskList=[],o.diskListSelectorData=[],o.selectedDisk=null,o.closeModal=function(){a.dismiss("cancel")},o.attachDisk=function(){var i={vmId:c.id,volumeId:o.selectedDisk.value};o.isFormSubmiting=!0,t.doPost(e.urls.disk_attach.replace("{region}",s),i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("挂载云硬盘成功")):(o.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"挂载云硬盘失败"),o.isFormSubmiting=!1)})};var l=function(){u()},u=function(){t.doGet(e.urls.disk_list.replace("{region}",s),{name:"",currentPage:"",recordsPerPage:""}).then(function(e,t,n,i){o.diskList=e.data.data,o.diskListSelectorData=o.diskList.filter(function(e){return e.name&&"available"===e.status}).map(function(e){return new r.SelectModel(e.name,e.id)}),o.selectedDisk=o.diskListSelectorData[0]})};l()}]),e.controller("DiskDetachModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","vm",function(e,t,n,i,r,o,a,s,c){o.diskList=[],o.diskListSelectorData=[],o.selectedDisk=null,o.closeModal=function(){a.dismiss("cancel")},o.detachDisk=function(){var i={vmId:c.id,volumeId:o.selectedDisk.value};o.isFormSubmiting=!0,t.doPost(e.urls.disk_detach.replace("{region}",s),i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("卸载云硬盘成功")):(o.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"卸载云硬盘失败"),o.isFormSubmiting=!1)})};var l=function(){u()},u=function(){o.diskList=c.volumes,o.diskListSelectorData=o.diskList.filter(function(e){return e.name}).map(function(e){return new r.SelectModel(e.name,e.id)}),o.selectedDisk=o.diskListSelectorData[0]};l()}]),e.controller("FloatingIpBindModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","vm",function(e,t,n,i,r,o,a,s,c){o.floatingIpList=[],o.floatingIpListSelectorData=[],o.selectedFloatingIp=null,o.closeModal=function(){a.dismiss("cancel")},o.bindFloatingIp=function(){var i={region:s,vmId:c.id,floatingIpId:o.selectedFloatingIp.value};o.isFormSubmiting=!0,t.doPost(e.urls.floatIp_bindVm,i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("绑定公网IP成功")):(o.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"绑定公网IP失败"),o.isFormSubmiting=!1)})};var l=function(){u()},u=function(){t.doGet(e.urls.floatIP_list,{region:s,name:"",currentPage:"",recordsPerPage:""}).then(function(e,t,n,i){o.floatingIpList=e.data.data,o.floatingIpListSelectorData=o.floatingIpList.filter(function(e){return"AVAILABLE"===e.status}).map(function(e){return new r.SelectModel(e.name,e.id)}),o.selectedFloatingIp=o.floatingIpListSelectorData[0]})};l()}]),e.controller("VmSnapshotCreateModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","vm",function(e,t,n,i,r,o,a,s,c){o.vmSnapshotName="",o.closeModal=function(){a.dismiss("cancel")},o.createVmSnapshot=function(){var i={region:s,vmId:c.id,name:o.vmSnapshotName};o.isFormSubmiting=!0,t.doPost(e.urls.snapshot_vm_create,i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("创建云主机快照成功，请前往快照页面查看。")):(n.notifyError(e.msgs[0]||"创建云主机快照失败"),o.isFormSubmiting=!1)})}}]),e.controller("VmPasswordChangeModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","vm",function(e,t,n,i,r,o,a,s,c){o.newPassword="",o.confirmPassword="",o.closeModal=function(){a.dismiss("cancel")},o.changeVmPassword=function(){var i={region:s,vmId:c.id,adminPass:o.confirmPassword};o.isFormSubmiting=!0,t.doPost(e.urls.vm_password_change,i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("修改密码成功")):(n.notifyError(e.msgs[0]||"修改密码失败"),o.isFormSubmiting=!1)})}}]),e.controller("VmEditModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","vm",function(e,t,n,i,r,o,a,s,c){o.vmName=c.name,o.closeModal=function(){a.dismiss("cancel")},o.editVm=function(){var i={region:s,vmId:c.id,name:o.vmName};o.isFormSubmiting=!0,t.doPost(e.urls.vm_rename,i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("编辑云主机成功")):(n.notifyError(e.msgs[0]||"编辑云主机失败"),o.isFormSubmiting=!1)})}}])}),define("controllers/VmCreateModalCtrl",["controllers/app.controller"],function(e){e.controller("VmCreateModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","ModelService","$scope","$modalInstance","$timeout","$window","$sce","$httpParamSerializerJQLike","$modal","region","vmSnapshot",function(e,t,n,i,r,o,a,s,c,l,u,d,m,f,p){a.isCalculatingPrice=!0,a.isDesignatedVmSnapshot=p?!0:!1,a.activeFlow=1,a.vmName="",a.imageActiveTab=a.isDesignatedVmSnapshot?"snapshot":"image",a.vmImageList=[],a.selectedVmImage=null,a.vmSnapshotList=[],a.selectedVmSnapshot=null,a.vmCpuList=[],a.selectedVmCpu=null,a.vmRamList=[],a.selectedVmRam=null,a.vmDiskTypeList=[],a.selectedVmDiskType=null,a.dataDiskVolume=10,a.vmNetworkType="primary",a.vmNetworkPublicIpModel="now",a.networkBandWidth=2,a.vmNetworkSubnetList=[],a.vmNetworkSubnetSelectorData=[],a.selectedVmNetworkSubnet=null,a.vmSecurityType="keypair",a.vmSecurityKeypairList=[],a.vmSecurityKeypairSelectorData=[],a.selectedVmSecurityKeypair=null,a.vmSecurityPassword={value:""},a.allVmBuyPeriods=e.allBuyPeriods,a.vmBuyPeriod=a.allVmBuyPeriods[0],a.vmCount=1,a.vmTotalPrice="",a.firstStepToNextTab=function(e){if(e.preventDefault(),a.vm_create_form.vm_name.$valid){if("snapshot"===a.imageActiveTab&&!a.vmSnapshotList.length)return void n.notifyWarning("你还没有快照，请去创建或者选择系统镜像。");a.activeFlow=2,a.hackRzSlider()}},a.thirdStepToNextTab=function(e){return e.preventDefault(),"private"!=a.vmNetworkType||a.vmNetworkSubnetList.length?(a.activeFlow=4,void a.hackRzSlider()):void n.notifyWarning("你还没有子网，请去私有网络中创建。")},a.closeModal=function(){s.dismiss("cancel")},a.hackRzSlider=i.getRzSliderHack(a),a.selectVmImage=function(e){a.selectedVmImage=e},a.isSelectedVmImage=function(e){return a.selectedVmImage===e},a.selectVmSnapshot=function(e){a.selectedVmSnapshot=e},a.isSelectedVmSnapshot=function(e){return a.selectedVmSnapshot===e},a.selectVmCpu=function(e){a.selectedVmCpu=e},a.isSelectedVmCpu=function(e){return a.selectedVmCpu===e},a.selectVmRam=function(e){a.selectedVmRam=e},a.isSelectedVmRam=function(e){return a.selectedVmRam===e},a.selectVmDiskType=function(e){e.enable&&(a.selectedVmDiskType=e)},a.isSelectedVmDiskType=function(e){return a.selectedVmDiskType===e},a.selectVmBuyPeriod=function(e){a.vmBuyPeriod=e},a.isSelectedVmBuyPeriod=function(e){return a.vmBuyPeriod===e},a.createVm=function(){var i={region:f,name:a.vmName,imageId:"image"===a.imageActiveTab?a.selectedVmImage.id:"",flavorId:g.id,volumeTypeId:a.selectedVmDiskType.id,volumeSize:a.dataDiskVolume,bindFloatingIp:"now"===a.vmNetworkPublicIpModel,sharedNetworkId:"primary"==a.vmNetworkType?h.id:"",bandWidth:a.networkBandWidth,adminPass:"password"==a.vmSecurityType?a.vmSecurityPassword.value:"",keyPairName:"keypair"==a.vmSecurityType?a.selectedVmSecurityKeypair.value:"",count:a.vmCount,privateSubnetId:"private"==a.vmNetworkType?a.selectedVmNetworkSubnet.value:"",snapshotId:"snapshot"===a.imageActiveTab?a.selectedVmSnapshot.id:"",order_time:a.vmBuyPeriod.toString()};a.isFormSubmiting=!0,t.doPost(e.urls.vm_buy,{paramsData:JSON.stringify(i),displayData:L()}).success(function(e,t,i,r){1===e.result?(s.close(e),l.location.href="/payment/"+e.data+"/2"):(n.notifyError(e.msgs[0]||"创建云主机失败"),a.isFormSubmiting=!1)})},a.openVmKeypairCreateModal=function(t){var i=m.open({animation:a.animationsEnabled,templateUrl:"/static/apps/cloudvm/templates/vm-keypair-create-modal.html",controller:"VmKeypairCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return r.regionId}}});i.result.then(function(t){t&&(a.keypairDownloadUrl=u.trustAsResourceUrl(e.urls.keypair_create+"?"+d(t)),c(function(){n.notifySuccess("创建密钥成功"),C()},2e3))},function(){})},a.$watch("selectedVmCpu",function(e){null!=e&&V()}),a.$watch("selectedVmRam",function(e){null!=e&&_()}),a.$watch(function(){return[a.vmNetworkType,a.vmNetworkPublicIpModel].join("_")},function(){"primary"==a.vmNetworkType&&"now"==a.vmNetworkPublicIpModel?a.networkBandWidth=2:a.networkBandWidth=0}),a.$watch(function(){return[a.selectedVmCpu,a.selectedVmRam,a.selectedVmDiskType&&a.selectedVmDiskType.name||"",a.dataDiskVolume,"primary"==a.vmNetworkType&&"now"==a.vmNetworkPublicIpModel?a.networkBandWidth:0,a.vmCount,a.vmBuyPeriod].join("_")},function(e){a.selectedVmCpu&&a.selectedVmRam&&a.selectedVmDiskType&&E()});var v=null,g=null,h=null,b=null,k=function(){S(),y(),w(),M(),P(),I(),C()},S=function(){a.isDesignatedVmSnapshot||t.doGet(e.urls.image_list,{region:f,name:"",currentPage:"",recordsPerPage:""}).then(function(e,t,n,i){a.vmImageList=e.data.data,a.selectedVmImage=a.vmImageList[0]})},y=function(){a.isDesignatedVmSnapshot?(a.vmSnapshotList.push(p),a.selectedVmSnapshot=a.vmSnapshotList[0]):t.doGet(e.urls.snapshot_vm_list,{region:f,name:"",currentPage:"",recordsPerPage:""}).then(function(e,t,n,i){a.vmSnapshotList=e.data.data,a.selectedVmSnapshot=a.vmSnapshotList[0]})},I=function(){t.doGet(e.urls.subnet_list,{region:f,name:"",currentPage:"",recordsPerPage:""}).then(function(e,t,n,i){a.vmNetworkSubnetList=e.data.data,a.vmNetworkSubnetSelectorData=a.vmNetworkSubnetList.map(function(e){return new o.SelectModel(e.name+"("+e.network.name+")",e.id)}),a.selectedVmNetworkSubnet=a.vmNetworkSubnetSelectorData[0]})},C=function(){t.doGet(e.urls.keypair_list,{region:f,name:"",currentPage:"",recordsPerPage:""}).then(function(e,t,n,i){e.data.data&&e.data.data.length&&(a.vmSecurityKeypairList=e.data.data,a.vmSecurityKeypairSelectorData.push(new o.SelectModel("请选择密钥","")),a.vmSecurityKeypairList.forEach(function(e){a.vmSecurityKeypairSelectorData.push(new o.SelectModel(e.name,e.name))}),a.selectedVmSecurityKeypair=a.vmSecurityKeypairSelectorData[0])})},w=function(){t.doGet(e.urls.flavor_group_data.replace("{region}",f)).then(function(e,t,n,i){v=e.data;for(var r in v)a.vmCpuList.push(r),a.vmCpuList.sort(function(e,t){return Number(e)-Number(t)});a.selectedVmCpu=a.vmCpuList[0]})},V=function(){a.vmRamList.splice(0,a.vmRamList.length);for(var e in v[a.selectedVmCpu])a.vmRamList.push(e),a.vmRamList.sort(function(e,t){return Number(e)-Number(t)});a.selectedVmRam=a.vmRamList[0]},_=function(){for(var e in v[a.selectedVmCpu][a.selectedVmRam]){g=v[a.selectedVmCpu][a.selectedVmRam][e];break}},M=function(){t.doGet(e.urls.vm_disk_type,{region:f}).then(function(e,t,n,i){a.vmDiskTypeList=e.data,a.selectedVmDiskType=a.vmDiskTypeList[0]})},P=function(){t.doGet(e.urls.vm_network_shared_list,{region:f}).then(function(e,t,n,i){h=e.data[0]})},E=function(){var i={region:f,order_time:a.vmBuyPeriod.toString(),order_num:a.vmCount.toString(),os_broadband:"primary"==a.vmNetworkType&&"now"==a.vmNetworkPublicIpModel?a.networkBandWidth.toString():"0",volumeType:a.selectedVmDiskType.name,volumeSize:a.dataDiskVolume.toString(),cpu_ram:a.selectedVmCpu+"_"+a.selectedVmRam};b=i,a.isCalculatingPrice=!0,t.doPost(e.urls.vm_calculate_price,i).success(function(e,t,i,r){a.isCalculatingPrice=!1,1===e.result?a.vmTotalPrice=e.data:n.notifyError(e.msgs[0]||"计算价格失败")})},L=function(){var e=[],t=[],n=[];return e.push("配置/:"+g.vcpus+"核, "+g.ram/1024+"G内存"),"snapshot"===a.imageActiveTab?e.push("快照/:"+a.selectedVmSnapshot.name):e.push("镜像/:"+a.selectedVmImage.name),e.push("地域/:"+r.allRegionData.filter(function(e){return e.id==f})[0].name),e.push("网络类型/:"+("primary"==a.vmNetworkType?"基础网络":"私有网络")),t.push("类型/:"+a.selectedVmDiskType.name),t.push("容量/:"+a.dataDiskVolume+"G数据盘"),"now"===a.vmNetworkPublicIpModel&&"primary"===a.vmNetworkType&&n.push("带宽/:"+a.networkBandWidth+"Mbps"),[e.join("/;"),t.join("/;"),n.join("/;")].join(";;")};k()}])}),define("controllers/ConfirmModalCtrl",["controllers/app.controller"],function(e){e.controller("ConfirmModalCtrl",["$scope","$modalInstance","message","title",function(e,t,n,i){e.confirmMessage=n,e.title=i,e.closeModal=function(){t.dismiss("cancel")},e.ok=function(){t.close(!0)},e.cancel=function(){t.dismiss("cancel")}}])}),define("controllers/VmDiskCrtl",["controllers/app.controller"],function(e){e.controller("VmDiskCrtl",["$scope","$interval","$modal","Config","Utility","HttpService","WidgetService","CurrentContext",function(e,t,n,i,r,o,a,s){e.searchName="",e.diskList=[],e.currentPage=1,e.totalItems=0,e.pageSize=10,e.operationBtn={};var c=new Array(6);e.onPageChange=function(){l()},e.doSearch=function(){l()},e.openVmDiskCreateModal=function(t){var i=n.open({animation:e.animationsEnabled,templateUrl:"/static/apps/cloudvm/templates/vm-disk-create-modal.html",controller:"VmDiskCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId},diskSnapshot:function(){return void 0}}});i.result.then(function(e){e&&1===e.result&&l()},function(){})},e.openVmDiskAttachModal=function(t){var i=u();if(1!==i.length)return void a.notifyWarning("请选中一个云硬盘");if("available"!==i[0].status)return void a.notifyWarning("云硬盘当前状态不可挂载到云主机");var r=n.open({animation:e.animationsEnabled,templateUrl:"VmDiskAttachModalTpl",controller:"VmDiskAttachModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId},disk:function(){return i[0]}}});r.result.then(function(e){e&&1===e.result&&l()},function(){})},e.detachDisk=function(){var e=u(),t="";if(1!==e.length)return void a.notifyWarning("请选中一个云硬盘");if(t=e[0].status,"in-use"!==e[0].status)return void a.notifyWarning("云硬盘当前状态不可卸载");var n={vmId:e[0].attachments[0].vmId,volumeId:e[0].id},r=a.openConfirmModal("卸载云硬盘","确定要从云主机（"+(e[0].attachments[0]&&e[0].attachments[0].vmName)+"）卸载云硬盘（"+e[0].name+"）吗？");r.result.then(function(s){return s?(a.notifyInfo("卸载云硬盘执行中..."),e[0].status="detaching",void o.doPost(i.urls.disk_detach.replace("{region}",e[0].region),n).success(function(n,i,o,s){1===n.result?(r.close(n),e[0].status="available",a.notifySuccess("卸载云硬盘成功"),l()):(e[0].status=t,a.notifyError(n.msgs[0]||"卸载云硬盘失败"))})):s},function(){})},e.deleteDisk=function(){var e=u(),t="";if(1!==e.length)return void a.notifyWarning("请选中一个云硬盘");if(t=e[0].status,"available"!==e[0].status&&"error"!==e[0].status)return void a.notifyWarning("卸载云硬盘后执行删除操作");var n={volumeId:e[0].id},r=a.openConfirmModal("删除云硬盘","确定要删除云硬盘（"+e[0].name+"）吗？");r.result.then(function(s){return s?(a.notifyInfo("删除云硬盘执行中..."),e[0].status="deleting",void o.doPost(i.urls.disk_delete.replace("{region}",e[0].region),n).success(function(n,i,o,s){1===n.result?(e[0].status="deleted",r.close(n),a.notifySuccess("删除云硬盘成功"),l()):(e[0].status=t,a.notifyError(n.msgs[0]||"删除云硬盘失败"))})):s},function(){})},e.openVmDiskEditModal=function(t){var i=u();if(1!==i.length)return void a.notifyWarning("请选中一个云硬盘");if("available"!==i[0].status&&"in-use"!==i[0].status)return void a.notifyWarning("云硬盘当前状态不可编辑");var r=n.open({animation:e.animationsEnabled,templateUrl:"VmDiskEditModalTpl",controller:"VmDiskEditModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId},disk:function(){return i[0]}}});r.result.then(function(e){e&&1===e.result&&l()},function(){})},e.openVmDiskSnapshotCreateModal=function(t){var i=u();if(1!==i.length)return void a.notifyWarning("请选中一个云硬盘");if("available"!==i[0].status&&"in-use"!==i[0].status)return void a.notifyWarning("云硬盘当前状态不可创建快照");var r=n.open({animation:e.animationsEnabled,templateUrl:"VmDiskSnapshotCreateModalTpl",controller:"VmDiskSnapshotCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId},disk:function(){return i[0]}}});r.result.then(function(e){e&&1===e.result},function(){})},e.isAllDiskChecked=function(){var t=e.diskList.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllDisk=function(){e.isAllDiskChecked()?e.diskList.forEach(function(e){e.checked=!1}):e.diskList.forEach(function(e){e.checked=!0})},e.checkDisk=function(e){e.checked=e.checked===!0?!1:!0};var l=function(){c=[];var n={name:e.searchName,currentPage:e.currentPage,recordsPerPage:e.pageSize};e.isListLoading=!0,o.doGet(i.urls.disk_list.replace("{region}",s.regionId),n).then(function(n,c,u,d){r.isServiceReady("serviceStatus3")||a.notifyWarning("服务未完全创建，请刷新试试看！"),e.isListLoading=!1,e.diskList=n.data.data,e.totalItems=n.data.totalRecords,e.diskList.filter(function(e){return"creating"==e.status}).forEach(function(e){var n=i.urls.disk_detail.replace("{region}",s.regionId).replace("{volumeId}",e.id),r=t(function(){o.doGet(n).then(function(n,i,o,a){1===n.result&&"creating"!=n.data.status&&(e.status=n.data.status,t.cancel(r),l())})},5e3)})})},u=function(){return e.diskList.filter(function(e){return e.checked===!0})},d=function(){var t={type:"disk",state:"status",other:["snapshots"],operations:["create","createsnap","attachdisk","edit","detachdisk","delete"]};e.$watch(function(){return e.diskList.map(function(e){return e.checked}).join(";")},function(){var n=r.setOperationBtns(e,e.diskList,t,c,i),o=t.operations;
for(var a in o)e.operationBtn[o[a]]=n[a]})};l(),d()}]),e.controller("VmDiskAttachModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","disk",function(e,t,n,i,r,o,a,s,c){o.vmList=[],o.vmListSelectorData=[],o.selectedVm=null,o.closeModal=function(){a.dismiss("cancel")},o.attachDisk=function(){var i={vmId:o.selectedVm.value,volumeId:c.id},r=c.status;c.status="attaching",o.isFormSubmiting=!0,t.doPost(e.urls.disk_attach.replace("{region}",s),i).success(function(e,t,i,s){1===e.result?(a.close(e),c.status="in-use",n.notifySuccess("挂载云硬盘成功")):(n.notifyError(e.msgs[0]||"挂载云硬盘失败"),c.status=r,o.isFormSubmiting=!1)})};var l=function(){u()},u=function(){t.doGet(e.urls.vm_list.replace("{region}",s),{name:"",currentPage:"",recordsPerPage:""}).then(function(e,t,n,i){o.vmList=e.data.data,o.vmListSelectorData=o.vmList.map(function(e){return new r.SelectModel(e.name,e.id)}),o.selectedVm=o.vmListSelectorData[0]})};l()}]),e.controller("VmDiskEditModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","disk",function(e,t,n,i,r,o,a,s,c){o.diskName=c.name,o.closeModal=function(){a.dismiss("cancel")},o.editDisk=function(){var i={region:s,volumeId:c.id,name:o.diskName,description:""};o.isFormSubmiting=!0,t.doPost(e.urls.disk_edit,i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("编辑云硬盘成功")):(n.notifyError(e.msgs[0]||"编辑云硬盘失败"),o.isFormSubmiting=!1)})}}]),e.controller("VmDiskSnapshotCreateModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region","disk",function(e,t,n,i,r,o,a,s,c){o.diskSnapshotName="",o.closeModal=function(){a.dismiss("cancel")},o.createDiskSnapshot=function(){var i={region:s,volumeId:c.id,name:o.diskSnapshotName};o.isFormSubmiting=!0,t.doPost(e.urls.snapshot_disk_create,i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("创建云硬盘快照成功，请前往快照页面查看。")):(n.notifyError(e.msgs[0]||"创建云硬盘快照失败"),o.isFormSubmiting=!1)})}}])}),define("controllers/VmDiskCreateModalCtrl",["controllers/app.controller"],function(e){e.controller("VmDiskCreateModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","ModelService","$scope","$modalInstance","$timeout","$window","region","diskSnapshot",function(e,t,n,i,r,o,a,s,c,l,u,d){var m=10,f=function(){p(),v()},p=function(){t.doGet(e.urls.vm_disk_type,{region:u}).then(function(e,t,n,i){a.diskTypeList=e.data,a.selectedDiskType=a.diskTypeList[0]})},v=function(){d?(a.snapshotList.push(d),a.snapshotListSelectorData=[new o.SelectModel(d.name,d.id)],a.selectedSnapshot=a.snapshotListSelectorData[0]):(a.snapshotListSelectorData.push(new o.SelectModel("请选择快照","")),a.selectedSnapshot=a.snapshotListSelectorData[0],t.doGet(e.urls.snapshot_disk_list,{region:u,name:"",currentPage:"",recordsPerPage:""}).then(function(e,t,n,i){a.snapshotList=e.data.data,a.snapshotList.forEach(function(e){a.snapshotListSelectorData.push(new o.SelectModel(e.name,e.id))})}))},g=function(){var i={region:u,order_time:a.diskBuyPeriod.toString(),order_num:a.diskCount.toString(),volumeType:a.selectedDiskType.name,volumeSize:a.diskVolume.toString()};a.isCalculatingPrice=!0,t.doPost(e.urls.disk_calculate_price,i).success(function(e,t,i,r){a.isCalculatingPrice=!1,1===e.result?a.totalPrice=e.data:n.notifyError(e.msgs[0]||"计算价格失败")})},h=function(){var e=[];return e.push(["类型",a.selectedDiskType.name].join("/:")),e.push(["容量",a.diskVolume+"GB"].join("/:")),e.join("/;")};i.getRzSliderHack(a)(),a.diskName="",a.diskTypeList=[],a.selectedDiskType=null,a.snapshotList=[],a.snapshotListSelectorData=[],a.selectedSnapshot=null,a.diskVolume=a.diskMinVolume=m,a.diskCount=1,a.allDiskBuyPeriods=e.allBuyPeriods,a.diskBuyPeriod=a.allDiskBuyPeriods[0],a.totalPrice="",a.closeModal=function(){s.dismiss("cancel")},a.isSelectedDiskType=function(e){return a.selectedDiskType===e},a.selectDiskType=function(e){e.enable&&(a.selectedDiskType=e)},a.createDisk=function(){var i={region:u,name:a.diskName,description:"",volumeTypeId:a.selectedDiskType.id,size:a.diskVolume,volumeSnapshotId:a.selectedSnapshot.value,count:a.diskCount,order_time:a.diskBuyPeriod.toString()};a.isFormSubmiting=!0,t.doPost(e.urls.disk_buy,{paramsData:JSON.stringify(i),displayData:h()}).success(function(e,t,i,r){1===e.result?(s.close(e),l.location.href="/payment/"+e.data+"/3"):(n.notifyError(e.msgs[0]||"创建云硬盘失败"),a.isFormSubmiting=!1)})},a.$watch("selectedSnapshot",function(e){if(e)if(e.value){var t=a.snapshotList.filter(function(t){return t.id===e.value})[0];t.size>m?a.diskMinVolume=t.size:a.diskMinVolume=m}else a.diskMinVolume=m}),a.$watch(function(){return[a.selectedDiskType&&a.selectedDiskType.name||"",a.diskCount,a.diskVolume,a.diskBuyPeriod].join("_")},function(e){a.selectedDiskType&&a.diskVolume&&a.diskCount&&a.diskBuyPeriod&&g()}),f()}])}),define("controllers/vpcController/SubnetCreateModalCtrl",["controllers/app.controller"],function(e){e.controller("SubnetCreateModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","CurrentContext","$scope","$modalInstance","$timeout","$window","subnetInfo",function(e,t,n,i,r,o,a,s,c,l,u){a.subnetCreate={name:""},a.closeModal=function(){s.dismiss("cancel")},a.createSubnet=function(){if(a.subnet_create_form.$valid){var i={region:u.region,networkId:a.selectedVpc.value,name:a.subnetCreate.name,cidr:a.selectedCidr.value,autoGatewayIp:"false",enableDhcp:"true",gatewayIp:a.selectedCidr.relatedOption.gatewayIp};a.isFormSubmiting=!0,t.doPost(e.urls.subnet_create,i).success(function(e,t,i,r){1===e.result?(s.close({result:1}),n.notifySuccess(e.msgs[0]||"创建子网成功")):(a.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"创建子网失败"))})}};var d=function(){m(),f()},m=function(){t.doGet(e.urls.vpc_list,{region:u.region}).then(function(e,t,n,i){a.vpcList=e.data.data,a.vpcListSelectorData=a.vpcList.map(function(e){return new r.SelectModel(e.name,e.id)}),a.selectedVpc=a.vpcListSelectorData[0]})},f=function(){t.doGet(e.urls.subnet_option_list).then(function(e,t,n,i){a.cidrs=e.data,a.cidrListSelectorData=a.cidrs.map(function(e){return new r.SelectModel(e.cidr,e.cidr,{gatewayIp:e.gatewayIp})}),a.selectedCidr=a.cidrListSelectorData[0]})};d()}]),e.controller("SubnetCreateWithVpcModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","CurrentContext","$scope","$modalInstance","$timeout","$window","subnetInfo",function(e,t,n,i,r,o,a,s,c,l,u){a.subnetCreate={name:"",vpcForSubnet:u.vpcForSubnet},a.closeModal=function(){s.dismiss("cancel")},a.createSubnet=function(){if(a.subnet_create_with_vpc_form.$valid){var i={region:u.region,networkId:u.vpcForSubnet.vpcId,name:a.subnetCreate.name,cidr:a.selectedCidr.value,autoGatewayIp:"false",enableDhcp:"true",gatewayIp:a.selectedCidr.relatedOption.gatewayIp};a.isFormSubmiting=!0,t.doPost(e.urls.subnet_create,i).success(function(e,t,i,r){1===e.result?(s.close({result:1}),n.notifySuccess(e.msgs[0]||"创建子网成功")):(a.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"创建子网失败"))})}};var d=function(){m()},m=function(){t.doGet(e.urls.subnet_option_list).then(function(e,t,n,i){a.cidrs=e.data,a.cidrListSelectorData=a.cidrs.map(function(e){return new r.SelectModel(e.cidr,e.cidr,{gatewayIp:e.gatewayIp})}),a.selectedCidr=a.cidrListSelectorData[0]})};d()}])}),define("controllers/vpcController/SubnetAssociateRouterModalCtrl",["controllers/app.controller"],function(e){e.controller("AssociateRouterModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","$timeout","$window","subnetInfo",function(e,t,n,i,r,o,a,s,c,l){o.associateSubnetName=l.subnetName,o.closeModal=function(){a.dismiss("cancel")},o.associateRouter=function(){var i={region:l.region,subnetId:l.subnetId,routerId:o.selectedRouter.value};o.isFormSubmiting=!0,t.doPost(e.urls.subnet_associate,i).success(function(e,t,i,r){1===e.result?(a.close({result:1}),n.notifySuccess(e.msgs[0]||"绑定路由器成功")):(o.isFormSubmiting=!1,a.dismiss("cancel"),n.notifyError(e.msgs[0]||"绑定路由器失败"))})};var u=function(){d()},d=function(){t.doGet(e.urls.router_list,{region:l.region}).then(function(e,t,n,i){o.routerList=e.data.data,o.routerListSelectorData=o.routerList.map(function(e){return new r.SelectModel(e.name,e.id)}),o.selectedRouter=o.routerListSelectorData[0]})};u()}])}),define("controllers/vpcController/SubnetEditModalCtrl",["controllers/app.controller"],function(e){e.controller("SubnetEditModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","$scope","$modalInstance","$timeout","$window","subnetInfo",function(e,t,n,i,r,o,a,s,c,l){o.subnetEdit={name:l.name},o.closeModal=function(){a.dismiss("cancel")},o.editSubnet=function(){if(o.subnet_edit_form.$valid){var i={region:l.region,subnetId:l.subnetId,name:o.subnetEdit.name,gatewayIp:l.gatewayIp,enableDhcp:!1};o.isFormSubmiting=!0,t.doPost(e.urls.subnet_edit,i).success(function(e,t,i,r){1===e.result?(a.close({result:1}),n.notifySuccess(e.msgs[0]||"编辑子网成功")):(o.isFormSubmiting=!1,a.dismiss("cancel"),n.notifyError(e.msgs[0]||"编辑子网失败"))})}}}])}),define("controllers/vpcController/VmVpcCtrl",["controllers/app.controller"],function(e){e.controller("VmVpcCtrl",["$scope","$interval","$modal","Config","Utility","HttpService","WidgetService","CurrentContext",function(e,t,n,i,r,o,a,s){e.tabShow="vpc",e.vpcList=[],e.subnetList=[],e.vpc=e.subnet={currentPage:1,totalItems:0,pageSize:10},e.operationBtn={};var c=[];e.vpc.onPageChange=function(){l()},e.subnet.onPageChange=function(){u()},e.openVpcCreateModal=function(t){var i=n.open({animation:e.animationsEnabled,templateUrl:"VpcCreateModalTpl",controller:"VpcCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId}}});i.result.then(function(e){e&&1===e.result&&l()},function(){})},e.openSubnetCreateModal=function(t){var i=n.open({animation:e.animationsEnabled,templateUrl:"SubnetCreateModalTpl",controller:"SubnetCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{subnetInfo:function(){return{region:s.regionId}}}});i.result.then(function(e){e&&1===e.result&&u()},function(){})},e.subnetCreateWithVpc=function(){var e=d();return 1!==e.length?void a.notifyWarning("请选中一个VPC"):void p("500",{region:e[0].region,vpcForSubnet:{vpcId:e[0].id,name:e[0].name}})},e.editVpc=function(){var e=d();return 1!==e.length?void a.notifyWarning("请选中一个VPC"):void f("500",{region:e[0].region,vpcId:e[0].id,name:e[0].name})},e.editSubnet=function(){var e=m();return 1!==e.length?void a.notifyWarning("请选中一个子网"):void g("500",{region:e[0].region,subnetId:e[0].id,name:e[0].name,gatewayIp:e[0].gatewayIp})},e.associateRouter=function(){var e=m();return 1!==e.length?void a.notifyWarning("请选中一个子网"):null!==e[0].router?void a.notifyWarning("当前子网已绑定路由器"):void v("500",{region:e[0].region,subnetId:e[0].id,subnetName:e[0].name})},e.deleteVpc=function(){var e=d();if(1!==e.length)return void a.notifyWarning("请选中一个VPC");var t={region:e[0].region,networkId:e[0].id},n=a.openConfirmModal("删除VPC","确定要删除VPC（"+e[0].name+"）吗？");n.result.then(function(e){return e?(a.notifyInfo("删除VPC执行中..."),void o.doPost(i.urls.vpc_delete,t).success(function(e,t,i,r){1===e.result?(n.close(e),a.notifySuccess("删除VPC成功"),l()):a.notifyError(e.msgs[0]||"删除VPC失败")})):e},function(){})},e.deleteSubnet=function(){var e=m();if(1!==e.length)return void a.notifyWarning("请选中一个子网");var t={region:e[0].region,subnetId:e[0].id},n=a.openConfirmModal("删除子网","确定要删除子网（"+e[0].name+"）吗？");n.result.then(function(r){return r?(a.notifyInfo("删除子网执行中..."),e[0].status="DELETEING",void o.doPost(i.urls.subnet_delete,t).success(function(t,i,r,o){1===t.result?(e[0].status="DELETED",n.close(t),a.notifySuccess("删除子网成功"),u()):a.notifyError(t.msgs[0]||"删除子网失败")})):r},function(){})},e.unbundRouter=function(){var e=m();if(1!==e.length)return void a.notifyWarning("请选中一个子网");if(null===e[0].router)return void a.notifyWarning("当前子网未绑定路由器");var t={region:e[0].region,subnetId:e[0].id,routerId:e[0].router.id},n=a.openConfirmModal("解绑路由器","确定要对子网（"+e[0].name+"）路由器解绑吗？");n.result.then(function(r){return r?(a.notifyInfo("解绑路由器执行中...."),e[0].status="UNBUNDLING",void o.doPost(i.urls.subnet_remove,t).success(function(t,i,r,o){1===t.result?(e[0].status="UNBUNDED",n.close(t),a.notifySuccess("解绑路由器成功"),u()):a.notifyError(t.msgs[0]||"子网路由解绑失败")})):r},function(){})},e.isAllVpcChecked=function(){var t=e.vpcList.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllVpc=function(){e.isAllVpcChecked()?e.vpcList.forEach(function(e){e.checked=!1}):e.vpcList.forEach(function(e){e.checked=!0})},e.checkVpc=function(e){e.checked=e.checked===!0?!1:!0},e.isAllSubnetChecked=function(){var t=e.subnetList.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllSubnet=function(){e.isAllSubnetChecked()?e.subnetList.forEach(function(e){e.checked=!1}):e.subnetList.forEach(function(e){e.checked=!0})},e.checkSubnet=function(e){e.checked=e.checked===!0?!1:!0},e.switchTabToSubnet=function(){e.tabShow="subnet",u(),h()},e.switchTabToVpc=function(){e.tabShow="vpc",l()},e.openSubnetAssociateVmModal=function(t){var i=m();if(1!==i.length)return void a.notifyWarning("请选中一个子网");var r=n.open({animation:e.animationsEnabled,templateUrl:"SubnetAssociateVmModalTpl",controller:"SubnetAssociateVmModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{subnetInfo:function(){return i[0]},region:function(){return s.regionId}}});r.result.then(function(e){e&&1===e.result&&u()},function(){})},e.openSubnetDetachVmModal=function(t){var i=m();if(1!==i.length)return void a.notifyWarning("请选中一个子网");var r=n.open({animation:e.animationsEnabled,templateUrl:"SubnetDetachVmModalTpl",controller:"SubnetDetachVmModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{subnetInfo:function(){return i[0]},region:function(){return s.regionId}}});r.result.then(function(e){e&&1===e.result&&u()},function(){})};var l=function(){var t={region:s.regionId,name:"",currentPage:e.vpc.currentPage,recordsPerPage:e.vpc.pageSize};e.isListLoading=!0,o.doGet(i.urls.vpc_list,t).then(function(t,n,i,r){e.isListLoading=!1,e.vpcList=t.data.data,e.vpc.totalItems=t.data.totalRecords})},u=function(){c=[];var t={region:s.regionId,name:"",currentPage:e.subnet.currentPage,recordsPerPage:e.subnet.pageSize};e.isListLoading=!0,o.doGet(i.urls.subnet_list,t).then(function(t,n,i,r){e.isListLoading=!1,e.subnetList=t.data.data,e.subnet.totalItems=t.data.totalRecords})},d=function(){return e.vpcList.filter(function(e){return e.checked===!0})},m=function(){return e.subnetList.filter(function(e){return e.checked===!0})},f=function(t,i){var r=n.open({animation:e.animationsEnabled,templateUrl:"VpcEditModalTpl",controller:"VpcEditModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{vpcInfo:function(){return i}}});r.result.then(function(e){e&&1===e.result&&l()},function(){})},p=function(t,i){var r=n.open({animation:e.animationsEnabled,templateUrl:"SubnetCreateWithVpcModalTpl",controller:"SubnetCreateWithVpcModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{subnetInfo:function(){return i}}});r.result.then(function(e){e&&1===e.result&&l()},function(){})},v=function(t,i){var r=n.open({animation:e.animationsEnabled,templateUrl:"AssociateRouterModalTpl",controller:"AssociateRouterModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{subnetInfo:function(){return i}}});r.result.then(function(e){e&&1===e.result&&u()},function(){})},g=function(t,i){var r=n.open({animation:e.animationsEnabled,templateUrl:"SubnetEditModalTpl",controller:"SubnetEditModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{subnetInfo:function(){return i}}});r.result.then(function(e){e&&1===e.result&&u()},function(){})},h=function(){var t={type:"subnet",state:"default",other:["router"],operations:["create","bindvm","bindrouter","unbindvm","unbindrouter","edit","delete"]};e.$watch(function(){return e.subnetList.map(function(e){return e.checked}).join(";")},function(){var n=r.setOperationBtns(e,e.subnetList,t,c,i),o=t.operations;for(var a in o)e.operationBtn[o[a]]=n[a]})};l()}]),e.controller("SubnetAssociateVmModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","$scope","modalInstance","$timeout","$window","region","subnetInfo",function(e,t,n,i,r,o,a,s,c,l,u){o.associatedVmList=[],o.selectedAssociatedVm=[],o.subnetAssociateVm={subnetName:u.name,subnetId:u.id},o.closeModal=function(){a.dismiss("cancel")},o.selectAssociatedVmImage=function(e){-1===o.selectedAssociatedVm.indexOf(e)?o.selectedAssociatedVm.push(e):o.selectedAssociatedVm.splice(o.selectedAssociatedVm.indexOf(e))},o.isSelectedAssociatedVmImage=function(e){return-1!==o.selectedAssociatedVm.indexOf(e)},o.associateVm=function(){if(0===o.selectedAssociatedVm.length)return void n.notifyError("至少选择一个要添加的云主机");for(var i={vmIds:"",region:l,subnetId:u.id},r=[],s=0,c=o.selectedAssociatedVm.length;c>s;s++)r.push(o.selectedAssociatedVm[s].id);i.vmIds=JSON.stringify(r),o.isFormSubmiting=!0,t.doPost(e.urls.subnet_attach_vm,i).success(function(e,t,i,r){1===e.result?(a.close({result:1}),n.notifySuccess(e.msgs[0]||"添加云主机成功")):(o.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"添加云主机失败"))})};var d=function(){m()},m=function(){t.doGet(e.urls.could_attach_subnet_list,{region:l,subnetId:u.id}).then(function(e,t,n,i){o.associatedVmList=e.data})};d()}]),e.controller("SubnetDetachVmModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","$scope","$modalInstance","$timeout","$window","region","subnetInfo",function(e,t,n,i,r,o,a,s,c,l,u){o.detachVmList=[],o.selectedDetachVm=[],o.subnetDetachVm={subnetName:u.name,subnetId:u.id},o.closeModal=function(){a.dismiss("cancel")},o.selectDetachVm=function(e){-1===o.selectedDetachVm.indexOf(e)?o.selectedDetachVm.push(e):o.selectedDetachVm.splice(o.selectedDetachVm.indexOf(e))},o.isSelectedDetachVmImage=function(e){return-1!==o.selectedDetachVm.indexOf(e)},o.detachVm=function(){if(0===o.selectedDetachVm.length)return void n.notifyError("至少选择一个要移除的云主机");for(var i={vmIds:"",region:l,subnetId:u.id},r=[],s=0,c=o.selectedDetachVm.length;c>s;s++)r.push(o.selectedDetachVm[s].id);i.vmIds=JSON.stringify(r),o.isFormSubmiting=!0,t.doPost(e.urls.subnet_detach_vm,i).success(function(e,t,i,r){1===e.result?(a.close({result:1}),n.notifySuccess(e.msgs[0]||"移除云主机成功")):(o.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"移除云主机失败"))})};var d=function(){m()},m=function(){t.doGet(e.urls.vm_attach_subnet_list,{region:l,subnetId:u.id}).then(function(e,t,n,i){o.detachVmList=e.data})};d()}])}),define("controllers/vpcController/VpcCreateModalCtrl",["controllers/app.controller"],function(e){e.controller("VpcCreateModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","CurrentContext","$scope","$modalInstance","$timeout","$window","region",function(e,t,n,i,r,o,a,s,c,l,u){a.vpcCreate={name:"",isCreateSubnet:"false",subnet:{name:""}},a.closeModal=function(){s.dismiss("cancel")},a.createVpc=function(){if(a.vpc_create_form.$valid){var i="";if("false"===a.vpcCreate.isCreateSubnet){i=e.urls.vpc_create;var r={region:u,name:a.vpcCreate.name}}else{i=e.urls.vpc_subnet_create;var r={region:u,networkName:a.vpcCreate.name,subnetName:a.vpcCreate.subnet.name,cidr:a.vpcCreate.subnet.selectedCidr.value,autoGatewayIp:!1,gatewayIp:a.vpcCreate.subnet.selectedCidr.relatedOption.gatewayIp}}a.isFormSubmiting=!0,t.doPost(i,r).success(function(e,t,i,r){1===e.result?(s.close({result:1}),n.notifySuccess(e.msgs[0]||"创建VPC成功")):(a.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"创建VPC失败"))})}};var d=function(){m()},m=function(){t.doGet(e.urls.subnet_option_list).then(function(e,t,n,i){a.vpcCreate.subnet.cidrs=e.data,a.vpcCreate.subnet.cidrListSelectorData=a.vpcCreate.subnet.cidrs.map(function(e){return new r.SelectModel(e.cidr,e.cidr,{gatewayIp:e.gatewayIp})}),a.vpcCreate.subnet.selectedCidr=a.vpcCreate.subnet.cidrListSelectorData[0]})};d()}])}),define("controllers/vpcController/VpcEditModalCtrl",["controllers/app.controller"],function(e){e.controller("VpcEditModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","$scope","$modalInstance","$timeout","$window","vpcInfo",function(e,t,n,i,r,o,a,s,c,l){o.vpcEdit={name:l.name},o.closeModal=function(){a.dismiss("cancel")},o.editVpc=function(){if(o.vpc_edit_form.$valid){var i={region:l.region,networkId:l.vpcId,name:o.vpcEdit.name};o.isFormSubmiting=!0,t.doPost(e.urls.vpc_edit,i).success(function(e,t,i,r){1===e.result?(a.close({result:1}),n.notifySuccess(e.msgs[0]||"编辑VPC成功")):(o.isFormSubmiting=!1,a.dismiss("cancel"),n.notifyError(e.msgs[0]||"编辑VPC失败"))})}}}])}),define("controllers/VmFloatIpCrtl",["controllers/app.controller"],function(e){e.controller("VmFloatIpCrtl",["$scope","$interval","Config","Utility","$modal","HttpService","WidgetService","CurrentContext",function(e,t,n,i,r,o,a,s){e.searchIpName="",e.floatIpList=[],e.currentPage=1,e.totalItems=0,e.pageSize=10,e.operationBtn={};var c=[];e.onPageChange=function(){l()},e.doSearch=function(){l()},e.isAllFipChecked=function(){var t=e.floatIpList.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllFip=function(){e.isAllFipChecked()?e.floatIpList.forEach(function(e){e.checked=!1}):e.floatIpList.forEach(function(e){e.checked=!0})},e.checkFip=function(e){e.checked=e.checked===!0?!1:!0},e.openIPcreateModal=function(t){var n=r.open({animation:e.animationsEnabled,templateUrl:"/static/apps/cloudvm/templates/vm-floatip-create-modal.html",controller:"VmIPcreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId}}});n.result.then(function(e){e&&1===e.result&&l()},function(){})},e.bindVm=function(t){var n=getCheckedIp();return 1!==n.length?void a.notifyWarning("请选中一个公网IP"):n[0].bindResource?void a.notifyError("已绑定云主机"):void o.doGet("/ecs/vm/unbindedfloatingip/list",{region:s.regionId}).then(function(i){if(1==i.result)if(i.data.length>0){var o=r.open({animation:e.animationsEnabled,templateUrl:"VmIPbindVmMOdalTpl",controller:"VmIpBindVmModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId},bindfloatIp:function(){return n[0]},avalibleVm:function(){return i.data}}});o.result.then(function(e){e&&1===e.result&&l()},function(){})}else a.notifyWarning("无可用云主机");else a.notifyError(i.msgs[0]||"请求出错")})},e.editIp=function(t){var n=getCheckedIp();if(1!==n.length)return void a.notifyWarning("请选中一个公网IP");var i=r.open({animation:e.animationsEnabled,templateUrl:"VmIpEditMOdalTpl",controller:"VmIpEditModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId},floatIp:function(){return n[0]}}});i.result.then(function(e){e&&1===e.result&&l()},function(){})},e.unbindVm=function(e){var t=getCheckedIp();if(1!==t.length)return void a.notifyWarning("请选中一个公网IP");if(!t[0].bindResource)return void a.notifyWarning("未绑定云主机");var i={region:t[0].region,vmId:t[0].bindResource.id,floatingIpId:t[0].id},r=a.openConfirmModal("解绑云主机","确定要（"+t[0].name+"）解绑云主机吗？");r.result.then(function(e){return e?(a.notifyInfo("解绑云主机执行中..."),t[0].status="AVAILABLE",void o.doPost(n.urls.floatIp_unbindVm,i).success(function(e,n,i,o){1===e.result?(t[0].status="AVAILABLE",r.close(e),a.notifySuccess("解绑云主机成功"),l()):a.notifyError(e.msgs[0]||"解绑云主机失败")})):e},function(){})},e.deleteIp=function(e){var t=getCheckedIp();if(1!==t.length)return void a.notifyWarning("请选中一个公网IP");var i={region:t[0].region,floatingIpId:t[0].id},r=a.openConfirmModal("删除公网IP","确定要删除公网IP（"+t[0].name+"）吗？");r.result.then(function(e){return e?(a.notifyInfo("删除公网IP执行中..."),t[0].status="DELETEING",void o.doPost(n.urls.floatIp_delete,i).success(function(e,n,i,o){1===e.result?(t[0].status="DELETED",r.close(e),a.notifySuccess("删除公网IP成功"),l()):a.notifyError(e.msgs[0]||"删除公网IP失败")})):e},function(){})};var l=function(){c=[];var t={region:s.regionId,name:e.searchIpName,currentPage:e.currentPage,recordsPerPage:e.pageSize};e.isListLoading=!0,o.doGet(n.urls.floatIP_list,t).then(function(t,n,r,o){e.isListLoading=!1,e.floatIpList=t.data.data,e.totalItems=t.data.totalRecords,i.isServiceReady("serviceStatus4")||a.notifyWarning("服务未完全创建，请刷新试试看！")})};getCheckedIp=function(){return e.floatIpList.filter(function(e){return e.checked===!0})};var u=function(){var t={type:"floatIp",state:"status",other:[],operations:["bindVm","edit","detach","delete"]};e.$watch(function(){return e.floatIpList.map(function(e){return e.checked}).join(";")},function(){var r=i.setOperationBtns(e,e.floatIpList,t,c,n),o=t.operations;for(var a in o)e.operationBtn[o[a]]=r[a]})};l(),u()}]),e.controller("VmIpBindVmModalCtrl",["Config","HttpService","WidgetService","ModelService","Utility","CurrentContext","$scope","$modalInstance","$timeout","$window","region","bindfloatIp","avalibleVm",function(e,t,n,i,r,o,a,s,c,l,u,d,m){a.floatIpName=d.name,a.floatIp=d.ipAddress,a.vmListSelectorData=m.map(function(e){return new i.SelectModel(e.name,e.id)}),a.selectedVm=a.vmListSelectorData[0],a.closeModal=function(){s.dismiss("cancel")},a.IpbingVm=function(){var i={region:u,vmId:a.selectedVm.value,floatingIpId:d.id};a.isFormSubmiting=!0,t.doPost(e.urls.floatIp_bindVm,i).success(function(e){0==e.result?(a.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"绑定云主机失败")):(s.close(e),n.notifySuccess("绑定云主机成功"))})}}]),e.controller("VmIpEditModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","$scope","$modalInstance","$timeout","$window","region","floatIp",function(e,t,n,i,r,o,a,s,c,l,u){i.getRzSliderHack(o)(),o.ipName=u.name,o.closeModal=function(){a.dismiss("cancel")},o.editIP=function(){if(o.vm_ip_edit_form.$valid){var i={region:l,floatingIpId:u.id,name:o.ipName};o.isFormSubmiting=!0,t.doPost(e.urls.floatIP_edit,i).success(function(e,t,i,r){1===e.result?(a.close(e),n.notifySuccess("编辑公网IP成功")):(o.isFormSubmiting=!1,n.notifyError(e.msgs[0]||"编辑公网IP失败"))})}}}])}),define("controllers/routerController/VmRouterCtrl",["controllers/app.controller"],function(e){e.controller("VmRouterCtrl",["$scope","$interval","$modal","Config","Utility","HttpService","WidgetService","CurrentContext",function(e,t,n,i,r,o,a,s){e.routerList=[],e.currentPage=1,e.totalItems=0,e.pageSize=10,e.operationBtn={};var c=[];e.onPageChange=function(){l()},e.doSearch=function(){l()},e.openVmRouterCreateModal=function(t){var i=n.open({animation:e.animationsEnabled,templateUrl:"VmRouterCreateModalTpl",controller:"VmRouterCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return s.regionId}}});i.result.then(function(e){e&&1===e.result&&l()},function(){})},e.isAllRouterChecked=function(){var t=e.routerList.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllRouter=function(){e.isAllRouterChecked()?e.routerList.forEach(function(e){e.checked=!1}):e.routerList.forEach(function(e){e.checked=!0})},e.checkRouter=function(e){e.checked=e.checked===!0?!1:!0},e.editRouter=function(){var e=u();return 1!==e.length?void a.notifyWarning("请选中一个路由器"):void d("500",{region:e[0].region,routerId:e[0].id,routerName:e[0].name,publicNetworkGatewayEnable:e[0].publicNetworkGatewayEnable,publicNetworkId:e[0].carrier?e[0].carrier.id:null})},e.associateSubnet=function(){var e=u();return 1!==e.length?void a.notifyWarning("请选中一个路由器"):void m("500",{region:e[0].region,routerId:e[0].id,routerName:e[0].name})},e.removeSubnet=function(){var e=u();return 1!==e.length?void a.notifyWarning("请选中一个路由器"):(console.log(e[0].subnets),0===e[0].subnets.length?void a.notifyWarning("选择的路由未关联子网"):void f("500",{region:e[0].region,routerId:e[0].id,routerName:e[0].name,subnets:e[0].subnets}))},e.deleteRouter=function(){var e=u();if(1!==e.length)return void a.notifyWarning("请选中一个路由器");var t={region:e[0].region,routerId:e[0].id},n=a.openConfirmModal("删除路由器","确定要删除路由器（"+e[0].name+"）吗？");n.result.then(function(r){return r?(a.notifyInfo("删除路由器执行中..."),e[0].status="DELETEING",void o.doPost(i.urls.router_delete,t).success(function(t,i,r,o){1===t.result?(e[0].status="DELETED",n.close(t),a.notifySuccess("删除路由器成功"),l()):a.notifyError(t.msgs[0]||"删除路由器失败")})):r},function(){})},e.functionDisable=function(){a.notifyWarning("此功能尚未开放,敬请期待...")};var l=function(){c=[];var t={name:e.searchRouterName,currentPage:e.currentPage,recordsPerPage:e.pageSize};e.isListLoading=!0,o.doGet(i.urls.router_list,t).then(function(t,n,i,o){r.isServiceReady("serviceStatus5")||a.notifyWarning("服务未完全创建，请刷新试试看！"),e.isListLoading=!1,e.routerList=t.data.data,e.totalItems=t.data.totalRecords})},u=function(){return e.routerList.filter(function(e){return e.checked===!0})},d=function(t,i){var r=n.open({animation:e.animationsEnabled,templateUrl:"VmRouterEditModalTpl",controller:"VmRouterEditModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{routerInfo:function(){return i}}});r.result.then(function(e){e&&1===e.result&&l()},function(){})},m=function(t,i){var r=n.open({animation:e.animationsEnabled,templateUrl:"AssociateSubnetModalTpl",controller:"AssociateSubnetModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{routerInfo:function(){return i}}});r.result.then(function(e){e&&1===e.result&&l()},function(){})},f=function(t,i){var r=n.open({animation:e.animationsEnabled,templateUrl:"RemoveSubnetModalTpl",controller:"RemoveSubnetModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{routerInfo:function(){return i}}});r.result.then(function(e){e&&1===e.result&&l()},function(){})},p=function(){var t={type:"router",state:"status",other:["subnets"],operations:["create","bindsubnet","edit","removesubnet","delete"]};e.$watch(function(){return e.routerList.map(function(e){return e.checked}).join(";")},function(){var n=r.setOperationBtns(e,e.routerList,t,c,i),o=t.operations;for(var a in o)e.operationBtn[o[a]]=n[a]})};l(),p()}])}),define("controllers/routerController/VmRouterCreateModalCtrl",["controllers/app.controller"],function(e){e.controller("VmRouterCreateModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","$scope","$modalInstance","$timeout","$window","region",function(e,t,n,i,r,o,a,s,c,l){o.routerName="",o.enablePublicNetworkGateway="true",o.publicNetworkId="",o.allRouteBuyPeriods=e.allBuyPeriods,o.routeBuyPeriod=o.allRouteBuyPeriods[0],o.closeModal=function(){a.dismiss("cancel")},o.createRouter=function(){var i={region:l,name:o.routerName,enablePublicNetworkGateway:o.enablePublicNetworkGateway,publicNetworkId:o.publicNetworkId,count:1,order_time:o.routeBuyPeriod.toString()};o.isFormSubmiting=!0,t.doPost(e.urls.router_buy,{paramsData:JSON.stringify(i),displayData:f()}).success(function(e,t,i,r){1===e.result?(a.close(e),c.location.href="/payment/"+e.data+"/5"):(n.notifyError(e.msgs[0]||"创建路由器失败"),o.isFormSubmiting=!1)})},o.$watch("routeBuyPeriod",function(e){e&&m()});var u=function(){d()},d=function(){t.doGet(e.urls.network_public_list,{region:l}).then(function(e,t,n,i){o.publicNetworkId=e.data[0].id})},m=function(){var i={region:l,order_time:o.routeBuyPeriod.toString(),order_num:"1",os_router:"router"};o.isCalculatingPrice=!0,t.doPost(e.urls.route_calculate_price,i).success(function(e,t,i,r){o.isCalculatingPrice=!1,1===e.result?o.totalPrice=e.data:n.notifyError(e.msgs[0]||"计算价格失败")})},f=function(){var e=[];return e.push(["公网网关","true"===o.enablePublicNetworkGateway?"开启":"关闭"].join("/:")),e.join("/;")};u()}])}),define("controllers/routerController/VmRouterEditModalCtrl",["controllers/app.controller"],function(e){e.controller("VmRouterEditModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","$scope","$modalInstance","$timeout","$window","routerInfo",function(e,t,n,i,r,o,a,s,c,l){function u(){t.doGet(e.urls.network_public_list,{region:l.region}).then(function(e,t,n,i){l.publicNetworkId=e.data[0].id})}o.editRouterName=l.routerName,o.editEnablePublicNetworkGateway=l.publicNetworkGatewayEnable,l.publicNetworkGatewayEnable===!1&&u(),o.closeModal=function(){a.dismiss("cancel")},o.editRouter=function(){if(o.vm_router_edit_form.$valid){var i={region:l.region,routerId:l.routerId,name:o.editRouterName,enablePublicNetworkGateway:o.editEnablePublicNetworkGateway,publicNetworkId:l.publicNetworkId
};o.isFormSubmiting=!0,t.doPost(e.urls.router_edit,i).success(function(e,t,i,r){1===e.result?(a.close({result:1}),n.notifySuccess(e.msgs[0]||"编辑路由器成功")):(o.isFormSubmiting=!1,a.dismiss("cancel"),n.notifyError(e.msgs[0]||"编辑路由器失败"))})}}}])}),define("controllers/routerController/RouterAssociateSubnetModalCtrl",["controllers/app.controller"],function(e){e.controller("AssociateSubnetModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","$timeout","$window","routerInfo",function(e,t,n,i,r,o,a,s,c,l){o.associateRouterName=l.routerName,o.selectedSubnet=null,o.closeModal=function(){a.dismiss("cancel")},o.associateSubnet=function(){var i={region:l.region,routerId:l.routerId,subnetId:o.selectedSubnet&&o.selectedSubnet.value};o.isFormSubmiting=!0,t.doPost(e.urls.subnet_associate,i).success(function(e,t,i,r){1===e.result?(a.close({result:1}),n.notifySuccess(e.msgs[0]||"关联子网成功")):(o.isFormSubmiting=!1,a.dismiss("cancel"),n.notifyError(e.msgs[0]||"关联子网失败"))})};var u=function(){d()},d=function(){t.doGet(e.urls.available_for_router_subnet_list,{region:l.region}).then(function(e,t,n,i){var a=e.data;o.subnetList=[];for(var s=0,c=a.length;c>s;s++)!function(e){for(var t=e.subnets,n=0,i=t.length;i>n;n++)t[n].nameWithVpc=t[n].name+"("+e.name+")",o.subnetList.push(t[n])}(a[s]);o.subnetListSelectorData=o.subnetList.map(function(e){return new r.SelectModel(e.nameWithVpc,e.id)}),o.selectedSubnet=o.subnetListSelectorData[0]})};u()}]),e.controller("RemoveSubnetModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","$timeout","$window","routerInfo",function(e,t,n,i,r,o,a,s,c,l){o.routerName=l.routerName,o.subnetList=l.subnets,o.subnetListSelectorData=o.subnetList.map(function(e){return new r.SelectModel(e.name,e.id)}),o.selectedSubnet=o.subnetListSelectorData[0],o.closeModal=function(){a.dismiss("cancel")},o.removeSubnet=function(){var i={region:l.region,routerId:l.routerId,subnetId:o.selectedSubnet.value};o.isFormSubmiting=!0,t.doPost(e.urls.subnet_remove,i).success(function(e,t,i,r){1===e.result?(a.close({result:1}),n.notifySuccess(e.msgs[0]||"解除关联子网成功")):(o.isFormSubmiting=!1,a.dismiss("cancel"),n.notifyError(e.msgs[0]||"解除关联子网失败"))})}}])}),define("controllers/VmIPcreateModalCtrl",["controllers/app.controller"],function(e){e.controller("VmIPcreateModalCtrl",["Config","HttpService","WidgetService","Utility","CurrentContext","$scope","$modalInstance","$timeout","$window","region",function(e,t,n,i,r,o,a,s,c,l){i.getRzSliderHack(o)(),o.networkBandWidth=2,o.ipName="",o.ipCount=1,o.carrierList="",o.selectedCarrier=null,o.allFloatipBuyPeriods=e.allBuyPeriods,o.floatipBuyPeriod=o.allFloatipBuyPeriods[0],o.totalPrice="",t.doGet("/osn/network/public/list",{region:l}).then(function(e){o.carrierList=e.data}),o.closeModal=function(){a.dismiss("cancel")},o.selectCarrier=function(e){o.selectedCarrier=e},o.isSelectedCarrier=function(e){return o.selectedCarrier=e},o.createIP=function(){var i={region:l,name:o.ipName,publicNetworkId:o.selectedCarrier.id,bandWidth:o.networkBandWidth,count:o.ipCount,order_time:o.floatipBuyPeriod.toString()};o.isFormSubmiting=!0,t.doPost(e.urls.floatip_buy,{paramsData:JSON.stringify(i),displayData:d()}).success(function(e,t,i,r){1===e.result?(a.close(e),c.location.href="/payment/"+e.data+"/4"):(n.notifyError(e.msgs[0]||"创建公网IP失败"),o.isFormSubmiting=!1)})},o.$watch(function(){return[o.ipCount,o.networkBandWidth,o.floatipBuyPeriod].join("_")},function(e){o.ipCount&&o.networkBandWidth&&o.floatipBuyPeriod&&u()});var u=function(){var i={region:l,order_time:o.floatipBuyPeriod.toString(),order_num:o.ipCount.toString(),os_broadband:o.networkBandWidth.toString()};o.isCalculatingPrice=!0,t.doPost(e.urls.floatip_calculate_price,i).success(function(e,t,i,r){o.isCalculatingPrice=!1,1===e.result?o.totalPrice=e.data:n.notifyError(e.msgs[0]||"计算价格失败")})},d=function(){var e=[];return e.push(["带宽",o.networkBandWidth+"Mbps"].join("/:")),e.join("/;")}}])}),define("controllers/VmSnapshotCrtl",["controllers/app.controller"],function(e){e.controller("VmSnapshotCrtl",["$scope","$interval","$modal","Config","HttpService","WidgetService","CurrentContext",function(e,t,n,i,r,o,a){var s=function(){var n=u(),o={region:a.regionId,name:"",currentPage:n?e.vmCurrentPage:e.diskCurrentPage,recordsPerPage:e.pageSize},c=n?i.urls.snapshot_vm_list:i.urls.snapshot_disk_list;e.isListLoading=!0,r.doGet(c,o).then(function(o,c,l,u){e.isListLoading=!1,n?(e.vmSnapshotList=o.data.data,e.vmTotalItems=o.data.totalRecords,e.vmSnapshotList.filter(function(e){return"QUEUED"==e.status}).forEach(function(e){var n=i.urls.snapshot_vm_detail,o={region:a.regionId,vmSnapshotId:e.id},c=t(function(){r.doGet(n,o).then(function(n,i,r,o){1===n.result&&"QUEUED"!=n.data.status&&(e.status=n.data.status,t.cancel(c),s())})},5e3)})):(e.diskSnapshotList=o.data.data,e.diskTotalItems=o.data.totalRecords,e.diskSnapshotList.filter(function(e){return"creating"==e.status}).forEach(function(e){var n=i.urls.snapshot_disk_detail.replace("{region}",a.regionId).replace("{volumeSnapshotId}",e.id),o=t(function(){r.doGet(n).then(function(n,i,r,a){1===n.result&&"creating"!=n.data.status&&(e.status=n.data.status,t.cancel(o),s())})},5e3)}))})},c=function(){var e=l();return e.filter(function(e){return e.checked===!0})},l=function(){return u()?e.vmSnapshotList:e.diskSnapshotList},u=function(){return"VmSnapshot"===e.tabShow};e.tabShow="VmSnapshot",e.vmSnapshotList=[],e.diskSnapshotList=[],e.vmCurrentPage=1,e.vmTotalItems=0,e.diskCurrentPage=1,e.diskTotalItems=0,e.pageSize=10,e.refreshSnapshotList=s,e.onPageChange=function(){s()},e.openVmDiskCreateModal=function(t){var i=c();if(1!==i.length)return void o.notifyWarning("请选中一个云硬盘快照");if("available"!==i[0].status)return void o.notifyWarning("快照当前状态不可创建云硬盘");var r=n.open({animation:e.animationsEnabled,templateUrl:"/static/apps/cloudvm/templates/vm-disk-create-modal.html",controller:"VmDiskCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return a.regionId},diskSnapshot:function(){return i[0]}}});r.result.then(function(e){e&&1===e.result},function(){})},e.openVmCreateModal=function(t){var s=c();if(1!==s.length)return void o.notifyWarning("请选中一个云主机快照");if("ACTIVE"!==s[0].status)return void o.notifyWarning("快照当前状态不可创建云主机");var l=n.open({animation:e.animationsEnabled,templateUrl:"/static/apps/cloudvm/templates/vm-create-modal.html",controller:"VmCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return a.regionId},vmSnapshot:function(){return s[0]},loadAllRegionData:function(e,t){if(t.allRegionData)return!0;var n=e.defer();return r.doGet(i.urls.region_list).then(function(e,i,r,o){t.allRegionData=e.data,n.resolve(!0)}),n.promise}}});l.result.then(function(e){e&&1===e.result},function(){})},e.deleteDiskSnapshot=function(){var e=c(),t="";if(1!==e.length)return void o.notifyWarning("请选中一个云硬盘快照");if(t=e[0].status,"available"!==e[0].status&&"error"!==e[0].status)return void o.notifyWarning("云硬盘快照当前状态不可删除");var n={region:e[0].region,snapshotId:e[0].id},a=o.openConfirmModal("删除云硬盘快照","确定要删除云硬盘快照（"+e[0].name+"）吗？");a.result.then(function(c){return c?(o.notifyInfo("删除云硬盘快照执行中..."),e[0].status="deleting",void r.doPost(i.urls.snapshot_disk_delete,n).success(function(n,i,r,c){1===n.result?(e[0].status="deleted",a.close(n),o.notifySuccess("删除云硬盘快照成功"),s()):(e[0].status=t,o.notifyError(n.msgs[0]||"删除云硬盘快照失败"))})):c},function(){})},e.deleteVmSnapshot=function(){var e=c(),t="";if(1!==e.length)return void o.notifyWarning("请选中一个云主机快照");if(t=e[0].status,"ACTIVE"!==t&&"KILLED"!==t)return void o.notifyWarning("云主机快照当前状态不可删除");var n={region:e[0].region,vmSnapshotId:e[0].id},a=o.openConfirmModal("删除云主机快照","确定要删除云主机快照（"+e[0].name+"）吗？");a.result.then(function(c){return c?(o.notifyInfo("删除云主机快照执行中..."),e[0].status="PENDING_DELETE",void r.doPost(i.urls.snapshot_vm_delete,n).success(function(n,i,r,c){1===n.result?(e[0].status="DELETED",a.close(n),o.notifySuccess("删除云主机快照成功"),s()):(e[0].status=t,o.notifyError(n.msgs[0]||"删除云主机快照失败"))})):c},function(){})},e.isAllSnapshotChecked=function(){var e=l(),t=e.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllSnapshot=function(){var t=l();e.isAllSnapshotChecked()?t.forEach(function(e){e.checked=!1}):t.forEach(function(e){e.checked=!0})},e.checkSnapshot=function(e){e.checked=e.checked===!0?!1:!0},s()}])}),define("controllers/VmImageCrtl",["controllers/app.controller"],function(e){e.controller("VmImageCrtl",["$scope","$interval","Config","$modal","HttpService","WidgetService","CurrentContext",function(e,t,n,i,r,o,a){e.searchName="",e.imageList=[],e.currentPage=1,e.totalItems=0,e.pageSize=10,e.onPageChange=function(){s()},e.doSearch=function(){s()},e.isAllImgChecked=function(){var t=e.imageList.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllimg=function(){e.isAllImgChecked()?e.imageList.forEach(function(e){e.checked=!1}):e.imageList.forEach(function(e){e.checked=!0})},e.checkimg=function(e){e.checked=e.checked===!0?!1:!0};var s=function(){var t={region:a.regionId,name:e.searchName,currentPage:e.currentPage,recordsPerPage:e.pageSize};e.isListLoading=!0,r.doGet(n.urls.image_list,t).then(function(t,n,i,r){e.isListLoading=!1,e.imageList=t.data.data,e.totalItems=t.data.totalRecords})};getCheckedImg=function(){return e.imageList.filter(function(e){return e.checked===!0})},s()}])}),define("controllers/VmKeypairCrtl",["controllers/app.controller"],function(e){e.controller("VmKeypairCrtl",["$scope","$interval","$modal","$timeout","$httpParamSerializerJQLike","$sce","Config","HttpService","WidgetService","CurrentContext",function(e,t,n,i,r,o,a,s,c,l){e.searchName="",e.keypairList=[],e.keypairDownloadUrl="",e.currentPage=1,e.totalItems=0,e.pageSize=10,e.onPageChange=function(){u()},e.doSearch=function(){u()},e.openVmKeypairCreateModal=function(t){var s=n.open({animation:e.animationsEnabled,templateUrl:"/static/apps/cloudvm/templates/vm-keypair-create-modal.html",controller:"VmKeypairCreateModalCtrl",size:t,backdrop:"static",keyboard:!1,resolve:{region:function(){return l.regionId}}});s.result.then(function(t){t&&(e.keypairDownloadUrl=o.trustAsResourceUrl(a.urls.keypair_create+"?"+r(t)),i(function(){c.notifySuccess("创建密钥成功"),u()},2e3))},function(){})},e.deleteKeypair=function(){var e=d();if(1!==e.length)return void c.notifyWarning("请选中一个密钥");var t={region:e[0].region,name:e[0].name},n=c.openConfirmModal("删除密钥","确定要删除密钥（"+e[0].name+"）吗？");n.result.then(function(e){return e?(c.notifyInfo("删除密钥执行中..."),void s.doPost(a.urls.keypair_delete,t).success(function(e,t,i,r){1===e.result?(n.close(e),c.notifySuccess("删除密钥成功"),u()):c.notifyError(e.msgs[0]||"删除密钥失败")})):e},function(){})},e.isAllKeypairChecked=function(){var t=e.keypairList.filter(function(e){return e.checked===!1||void 0===e.checked});return 0==t.length},e.checkAllKeypair=function(){e.isAllKeypairChecked()?e.keypairList.forEach(function(e){e.checked=!1}):e.keypairList.forEach(function(e){e.checked=!0})},e.checkKeypair=function(e){e.checked=e.checked===!0?!1:!0};var u=function(){var t={region:l.regionId,name:e.searchName,currentPage:e.currentPage,recordsPerPage:e.pageSize};e.isListLoading=!0,s.doGet(a.urls.keypair_list,t).then(function(t,n,i,r){e.isListLoading=!1,e.keypairList=t.data.data,e.totalItems=t.data.totalRecords})},d=function(){return e.keypairList.filter(function(e){return e.checked===!0})};u()}])}),define("controllers/VmKeypairCreateModalCtrl",["controllers/app.controller"],function(e){e.controller("VmKeypairCreateModalCtrl",["Config","HttpService","WidgetService","Utility","ModelService","$scope","$modalInstance","region",function(e,t,n,i,r,o,a,s){o.keypairName="",o.closeModal=function(){a.dismiss("cancel")},o.createKeypair=function(){var i={region:s,name:o.keypairName};o.isFormSubmiting=!0,t.doGet(e.urls.keypair_check,i,{disableGetGlobalNotify:!0}).then(function(e){a.close(i)},function(e){0===e.result&&(n.notifyError(e.msgs[0]||"密钥名称验证失败"),o.isFormSubmiting=!1)})}}])}),define("controllers/controllers",["controllers/app.controller","controllers/VirtualMachine","controllers/VmCreateModalCtrl","controllers/ConfirmModalCtrl","controllers/VmDiskCrtl","controllers/VmDiskCreateModalCtrl","controllers/vpcController/SubnetCreateModalCtrl","controllers/vpcController/SubnetAssociateRouterModalCtrl","controllers/vpcController/SubnetEditModalCtrl","controllers/vpcController/VmVpcCtrl","controllers/vpcController/VpcCreateModalCtrl","controllers/vpcController/VpcEditModalCtrl","controllers/VmFloatIpCrtl","controllers/routerController/VmRouterCtrl","controllers/routerController/VmRouterCreateModalCtrl","controllers/routerController/VmRouterEditModalCtrl","controllers/routerController/RouterAssociateSubnetModalCtrl","controllers/VmIPcreateModalCtrl","controllers/VmSnapshotCrtl","controllers/VmImageCrtl","controllers/VmKeypairCrtl","controllers/VmKeypairCreateModalCtrl"],function(e){}),define("../common/services/common.service",["angular"],function(e){return e.module("common.service",[])}),define("../common/services/Config",["./common.service"],function(e){e.factory("Config",[function(){var e={};return e.urls={vm_regions:"/ecs/regions/",region_list:"/ecs/region/list",vm_list:"/ecs/region/{region}",vm_detail:"/ecs/region/{region}/vm/{vmId}",not_in_any_network_vm_list:"/ecs/vm/notInAnyNetwork/list",could_attach_subnet_list:"/ecs/vm/couldAttachSubnet/list",vm_attach_subnet_list:"/ecs/vm/attached/subnet/list",image_list:"/osi/image/list",flavor_group_data:"/osf/region/{region}/group",vm_create_old:"/ecs/region/{region}/vm-create",vm_create:"/ecs/vm/create",vm_buy:"/billing/buy/2",disk_buy:"/billing/buy/3",floatip_buy:"/billing/buy/4",router_buy:"/billing/buy/5",vm_rename:"/ecs/vm/rename",vm_start:"/ecs/region/{region}/vm-start",vm_stop:"/ecs/region/{region}/vm-stop",vm_reboot:"/ecs/vm/reboot",vm_delete:"/ecs/region/{region}/vm-delete",vm_password_change:"/ecs/vm/changeAdminPass",vm_disk_type:"/osv/volume/type/list",vm_network_shared_list:"/osn/network/shared/list",vm_calculate_price:"/billing/calculate/price/2",disk_calculate_price:"/billing/calculate/price/3",floatip_calculate_price:"/billing/calculate/price/4",route_calculate_price:"/billing/calculate/price/5",disk_list:"/osv/region/{region}",disk_detail:"/osv/region/{region}/volume/{volumeId}",disk_create:"/osv/region/{region}/volume-create",disk_delete:"/osv/region/{region}/volume-delete",disk_attach:"/ecs/region/{region}/vm-attach-volume",disk_detach:"/ecs/region/{region}/vm-detach-volume",disk_edit:"/osv/volume/edit",subnet_list:"/osn/subnet/private/list",subnet_option_list:"/osn/subnet/option/list",subnet_create:"/osn/subnet/private/create",subnet_delete:"/osn/subnet/private/delete",subnet_edit:"/osn/subnet/private/edit",subnet_attach_vm:"/ecs/vm/attach/subnet",subnet_detach_vm:"/ecs/vm/detach/subnet",vpc_list:"/osn/network/private/list",vpc_delete:"/osn/network/private/delete",vpc_create:"/osn/network/private/create",vpc_subnet_create:"/osn/network/subnet/private/create",vpc_edit:"/osn/network/private/edit",router_list:"/osn/router/list",network_public_list:"/osn/network/public/list",available_for_router_subnet_list:"/osn/network/private/available_for_router_interface/list",subnet_associate:"/osn/router/subnet/associate",subnet_remove:"/osn/router/subnet/separate",router_create:"/osn/router/create",router_edit:"/osn/router/edit",router_delete:"/osn/router/delete",floatIP_list:"/osn/floatingip/list",floatIP_create:"/osn/floatingip/create",floatIp_delete:"/osn/floatingip/delete",floatIP_edit:"/osn/floatingip/edit",floatIp_bindVm:"/ecs/vm/floatingip/bind",floatIp_unbindVm:"/ecs/vm/floatingip/unbind",snapshot_disk_list:"/osv/volume/snapshot/list",snapshot_disk_detail:"/osv/region/{region}/volume/snapshot/{volumeSnapshotId}",snapshot_disk_create:"/osv/volume/snapshot/create",snapshot_disk_delete:"/osv/volume/snapshot/delete",snapshot_vm_list:"/ecs/vm/snapshot/list",snapshot_vm_detail:"/ecs/vm/snapshot/detail",snapshot_vm_create:"/ecs/vm/snapshot/create",snapshot_vm_delete:"/ecs/vm/snapshot/delete",vm_vnc:"/ecs/region/{region}/vm-open-console",keypair_list:"/ecs/keypair/list",keypair_create:"/ecs/keypair/create",keypair_delete:"/ecs/keypair/delete",keypair_check:"/ecs/keypair/create/check"},e.REGEX={NAME:/^[a-zA-Z\u4e00-\u9fa5][a-zA-Z0-9\u4e00-\u9fa5\(（_\-\)）]{1,127}$/,NAME_KEYPAIR:/^[a-zA-Z][a-zA-Z0-9_\-]{1,127}$/,PASSWORD:/^(?=.*[0-9].*)(?=.*[A-Z].*)(?=.*[a-z].*)[a-zA-Z0-9]{8,30}$/},e.REGEX_MESSAGE={NAME:"名称须为2-128个字符，支持大小写字母数字或中文以及()（）_-，以大小写字母或中文开头",NAME_KEYPAIR:"名称须为2-128个字符，支持大小写字母数字以及_-，以大小写字母开头",PASSWORD:"8-30个字符，同时包含大小写字母和数字，不支持特殊符号"},e.vmStatuses={active:"活跃",building:"创建中",paused:"已暂停",suspended:"已挂起",stopped:"已关机",error:"异常",deleted:"已删除",arrearaged:"欠费停机"},e.vmTaskStatuses={building:"创建中",deleting:"删除中",stopping:"关机中",starting:"启动中",rebooting:"重启中",scheduling:"创建中",block_device_mapping:"创建中",spawning:"创建中",image_snapshotting:"快照创建中",image_uploading:"快照上传中",updating_password:"密码修改中",suspending:"挂起中",resuming:"恢复中",networking:"网络挂载中"},e.vmDiskStatuses=[{text:"创建中",value:"creating"},{text:"可用",value:"available"},{text:"挂载中",value:"attaching"},{text:"使用中",value:"in-use"},{text:"删除中",value:"deleting"},{text:"异常",value:"error"},{text:"已删除",value:"deleted"},{text:"卸载中",value:"detaching"}],e.vmVpcStatuses=[{text:"活跃",value:"ACTIVE"},{text:"可用",value:"DOWN"},{text:"创建中",value:"BUILD"},{text:"不可用",value:"ERROR"},{text:"不可用",value:"UNRECOGNIZED"}],e.vmFloatIpStatuses={AVAILABLE:"可用",BINDED:"已绑定"},e.vmImageStatuses=[{text:"未识别",value:"UNRECOGNIZED"},{text:"活跃",value:"ACTIVE"},{text:"上传中",value:"SAVING"},{text:"等待上传",value:"QUEUED"},{text:"停止",value:"KILLED"},{text:"删除等待",value:"PENDING_DELETE"},{text:"删除",value:"DELETED"},{text:"无",value:"NIL"}],e.allBuyPeriods=[1,2,3,4,5,6,7,8,9,12,24,36],e.serverName={uc:"lcp-uc.letvcloud.com",matrix:"matrix.letvclond.com"},e.EMPTY_TEXT="--",e.statusOperations={virtualMachine:{active:{create:1,start:0,stop:1,restart:1,createsnap:1,changeconfig:0,attachdisk:1,detachdisk:1,bindfloatIp:1,unbindfloatIp:1,joinnet:1,bindalarm:1,vnc:1,editssh:1,editpass:1,"delete":1},stopped:{create:1,start:1,stop:0,restart:0,createsnap:1,changeconfig:0,attachdisk:1,detachdisk:1,bindfloatIp:1,unbindfloatIp:1,joinnet:1,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":1},building:{create:0,start:0,stop:0,restart:0,createsnap:0,changeconfig:0,attachdisk:0,detachdisk:0,bindfloatIp:0,unbindfloatIp:0,joinnet:0,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":0},deleting:{create:0,start:0,stop:0,restart:0,createsnap:0,changeconfig:0,attachdisk:0,detachdisk:0,bindfloatIp:0,unbindfloatIp:0,joinnet:0,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":0},stopping:{create:0,start:0,stop:0,restart:0,createsnap:0,changeconfig:0,attachdisk:0,detachdisk:0,bindfloatIp:0,unbindfloatIp:0,joinnet:0,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":0},starting:{create:0,start:0,stop:0,restart:0,createsnap:0,changeconfig:0,attachdisk:0,detachdisk:0,bindfloatIp:0,unbindfloatIp:0,joinnet:0,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":0},rebooting:{create:0,start:0,stop:0,restart:0,createsnap:0,changeconfig:0,attachdisk:0,detachdisk:0,bindfloatIp:0,unbindfloatIp:0,joinnet:0,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":0},spawning:{create:0,start:0,stop:0,restart:0,createsnap:0,changeconfig:0,attachdisk:0,detachdisk:0,bindfloatIp:0,unbindfloatIp:0,joinnet:0,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":0},deleted:{create:1,start:0,stop:0,restart:0,createsnap:0,changeconfig:0,attachdisk:0,detachdisk:0,bindfloatIp:0,unbindfloatIp:0,joinnet:0,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":0},error:{create:1,start:0,stop:0,restart:0,createsnap:0,changeconfig:0,attachdisk:0,detachdisk:0,bindfloatIp:0,unbindfloatIp:0,joinnet:0,bindalarm:0,vnc:0,editssh:0,editpass:0,"delete":1},"default":{create:1,start:1,stop:1,restart:1,createsnap:1,changeconfig:1,attachdisk:1,detachdisk:1,bindfloatIp:1,unbindfloatIp:1,joinnet:1,bindalarm:1,vnc:1,editssh:1,editpass:1,"delete":1},volumes:{create:1,start:1,stop:1,restart:1,createsnap:1,changeconfig:1,attachdisk:1,detachdisk:1,bindfloatIp:1,unbindfloatIp:1,joinnet:1,bindalarm:1,vnc:1,editssh:1,editpass:1,"delete":1},volumesnull:{create:1,start:1,stop:1,restart:1,createsnap:1,changeconfig:1,attachdisk:1,detachdisk:0,bindfloatIp:1,unbindfloatIp:1,joinnet:1,bindalarm:1,vnc:1,editssh:1,editpass:1,"delete":1},"public":{create:1,start:1,stop:1,restart:1,createsnap:1,changeconfig:1,attachdisk:1,detachdisk:1,bindfloatIp:0,unbindfloatIp:1,joinnet:1,bindalarm:1,vnc:1,editssh:1,editpass:1,"delete":1},publicnull:{create:1,start:1,stop:1,restart:1,createsnap:1,changeconfig:1,attachdisk:1,detachdisk:1,bindfloatIp:1,unbindfloatIp:0,joinnet:1,bindalarm:1,vnc:1,editssh:1,editpass:1,"delete":1}},disk:{creating:{create:0,createsnap:0,attachdisk:0,detachdisk:0,expandVolume:0,"delete":0,edit:0},available:{create:1,createsnap:1,attachdisk:1,detachdisk:0,expandVolume:1,"delete":1,edit:1},attaching:{create:0,createsnap:0,attachdisk:0,detachdisk:0,expandVolume:0,"delete":0,edit:0},"in-use":{create:1,createsnap:1,attachdisk:0,detachdisk:1,expandVolume:0,"delete":0,edit:1},deleting:{create:0,createsnap:0,attachdisk:0,detachdisk:0,expandVolume:0,"delete":0,edit:0},error:{create:1,createsnap:0,attachdisk:0,detachdisk:0,expandVolume:0,"delete":0,edit:0},deleted:{create:1,createsnap:0,attachdisk:0,detachdisk:0,expandVolume:0,"delete":0,edit:0},detaching:{create:0,createsnap:0,attachdisk:0,detachdisk:0,expandVolume:0,"delete":0,edit:0},"default":{create:1,createsnap:1,attachdisk:1,detachdisk:1,expandVolume:1,"delete":1,edit:1},snapshots:{create:1,createsnap:1,attachdisk:1,detachdisk:1,expandVolume:1,"delete":0,edit:1},snapshotsnull:{create:1,createsnap:1,attachdisk:1,detachdisk:1,expandVolume:1,"delete":1,edit:1}},floatIp:{AVAILABLE:{bindVm:1,bindRouter:1,bindBalance:1,changeBandwidth:1,detach:0,bindalarm:1,edit:1,"delete":1},BINDED:{bindVm:0,bindRouter:0,bindBalance:0,changeBandwidth:0,detach:1,bindalarm:1,edit:1,"delete":0},"default":{bindVm:1,bindRouter:1,bindBalance:1,changeBandwidth:1,detach:1,bindalarm:1,edit:1,"delete":1}},router:{ACTIVE:{create:1,bindIp:1,unbindIp:1,bindsubnet:1,removesubnet:1,edit:1,bindalarm:1,"delete":1},DOWN:{create:1,bindIp:0,unbindIp:1,bindsubnet:0,removesubnet:1,edit:1,bindalarm:1,"delete":1},BUILD:{create:0,bindIp:0,unbindIp:0,bindsubnet:0,removesubnet:0,edit:0,bindalarm:0,"delete":0},ERROR:{create:1,bindIp:0,unbindIp:0,bindsubnet:0,removesubnet:0,edit:0,bindalarm:0,"delete":0},UNRECOGNIZED:{create:1,bindIp:0,unbindIp:0,bindsubnet:0,removesubnet:0,edit:0,bindalarm:0,"delete":0},subnets:{create:1,bindIp:1,unbindIp:1,bindsubnet:1,removesubnet:1,edit:1,bindalarm:1,"delete":0},subnetsnull:{create:1,bindIp:1,unbindIp:1,bindsubnet:1,removesubnet:0,edit:1,bindalarm:1,"delete":1},"default":{create:1,bindIp:1,unbindIp:1,bindsubnet:1,removesubnet:1,edit:1,bindalarm:1,"delete":1}},subnet:{vm:{create:1,bindvm:1,unbindvm:1,bindrouter:1,unbindrouter:1,edit:1,"delete":1},vmnull:{create:1,bindvm:1,unbindvm:0,bindrouter:1,unbindrouter:1,edit:1,"delete":1},router:{create:1,bindvm:1,unbindvm:1,bindrouter:0,unbindrouter:1,edit:1,"delete":1},routernull:{create:1,bindvm:1,unbindvm:1,bindrouter:1,unbindrouter:0,edit:1,"delete":1},"default":{create:1,bindvm:1,unbindvm:1,bindrouter:1,unbindrouter:1,edit:1,"delete":1}}},e}])}),define("../common/services/HttpService",["./common.service"],function(e){e.factory("HttpService",["$http","$q","$window","WidgetService",function(e,t,n,i){var r={};return r.doGet=function(r,o,a){var s=t.defer();return e.get(r,angular.extend({params:o},a)).success(function(e,t,r,o){1===e.result?s.resolve(e):2===e.result?n.location.reload():(s.reject(e),a&&a.disableGetGlobalNotify||i.notifyError(e.msgs[0]||"获取数据失败"))}),s.promise},r.doPost=function(t,n,i){return e.post(t,n,i)},r}])}),define("../common/services/WidgetService",["./common.service"],function(e){e.factory("WidgetService",["$modal","toaster",function(e,t){var n={};return n.openConfirmModal=function(t,n){return e.open({templateUrl:"/static/apps/cloudvm/templates/confirm-modal.html",controller:"ConfirmModalCtrl",size:"small",resolve:{message:function(){return n},title:function(){return t}}})},n.notifyError=function(e){t.pop("error",null,e,2e3,"trustedHtml")},n.notifyInfo=function(e){t.pop("info",null,e,2e3,"trustedHtml")},n.notifySuccess=function(e){t.pop("success",null,e,2e3,"trustedHtml")},n.notifyWarning=function(e){t.pop("warning",null,e,2e3,"trustedHtml")},n.showSpin=function(e){$("body").append('<div class="spin"></div>'),$("body").append('<div class="far-spin"></div>')},n.hideSpin=function(e){$("body").find(".spin").remove(),$("body").find(".far-spin").remove()},n}])}),define("../common/services/CurrentContext",["./common.service","jquery"],function(e,t){e.factory("CurrentContext",[function(){var e={};return e.regionId=t("#region_id").val(),e.allRegionData=null,e}])}),define("../common/services/Utility",["./common.service"],function(e){e.factory("Utility",["$timeout","$document",function(e,t){var n={};n.getRzSliderHack=function(t){return function(){e(function(){t.$broadcast("rzSliderForceRender")},50)}},n.delayQueueModel=function(){var t=[],n=null;return function(i,r){0==t.length&&(n=e(function(){r(t[t.length-1]),t.splice(0,t.length)},1e3)),t.push(i)}};var i=function(e,t){var n=[],i="",r="",o=!1;if(t.indexOf(".")>0){n=t.split(".");var a="";for(var s in n)a=a?a:e,a=a[n[s]],r=n[s];i=a}else r=t,i=e[t];return i instanceof Array?i.length>0&&(o=!0):i&&(o=!0),{flag:o,pathvalue:r}};n.setOperationBtns=function(e,t,n,r,o){var a=n.type,s=n.state,c=n.other,l=n.operations,u=[],d="";for(var m in t)if(r[m]=[],t[m].checked){var f=t[m];d=f[s]?f[s]:"default";for(var p in l){if(r[m][p]=r[m][p]?r[m][p]:o.statusOperations[a][d][l[p]],c.length>0)for(var v in c){var g=i(f,c[v]).flag,h=i(f,c[v]).pathvalue;g?r[m][p]=r[m][p]*o.statusOperations[a][h][l[p]]:r[m][p]=r[m][p]*o.statusOperations[a][h+"null"][l[p]]}else r[m][p]=o.statusOperations[a][d][l[p]];u[p]=1}}else r[m]=[1,1,1,1,1,1,1,1,1,1,1,1];for(var m in r)for(var p in r[m])u[p]=u[p]*r[m][p];return u};var r=function(e){for(var n=t[0].cookie.split(";"),i=0;i<n.length;i++){var r=n[i].split("=");if(r[0]==e)return r[1]}return""},o=function(e,n){t[0].cookie=e+"="+n+";"};return n.isServiceReady=function(e){var t=!1,n=r(e);return n&&"notready"==n?o(e,""):t=!0,t},n.isInt=function(e){return Number(e)%1===0},n}])}),define("../common/services/ModelService",["./common.service"],function(e){e.factory("ModelService",["$modal","toaster",function(e,t){var n={};return n.SelectModel=function(e,t,n){this.text=e,this.value=t,this.relatedOption=n||{}},n}])}),define("../common/services/services",["./common.service","./Config","./HttpService","./WidgetService","./CurrentContext","./Utility","./ModelService"],function(e){}),define("../common/directives/common.directive",["angular"],function(e){return e.module("common.directive",[])}),define("../common/directives/directives",["./common.directive"],function(e){e.directive("passwordVerify",function(){return{require:"ngModel",scope:{passwordVerify:"="},link:function(e,t,n,i){var r=!0;e.$watch(function(){var t;return(e.passwordVerify||i.$viewValue)&&(t=e.passwordVerify+"_"+i.$viewValue),t},function(t){return r?(r=!1,i.$setValidity("passwordVerify",!0),!0):void(t&&i.$parsers.unshift(function(t){var n=e.passwordVerify;return n!==t?void i.$setValidity("passwordVerify",!1):(i.$setValidity("passwordVerify",!0),t)}))})}}}),e.directive("nameInputRestrict",["Config",function(e){return{require:"ngModel",link:function(t,n,i,r){r.$validators.nameInputRestrict=function(t,n){return n&&e.REGEX.NAME.test(n)?!0:!1}}}}]),e.directive("nameInputKeypairRestrict",["Config",function(e){return{require:"ngModel",link:function(t,n,i,r){r.$validators.nameInputKeypairRestrict=function(t,n){return n&&e.REGEX.NAME_KEYPAIR.test(n)?!0:!1}}}}]),e.directive("passwordRestrict",["Config",function(e){return{require:"ngModel",link:function(t,n,i,r){r.$validators.passwordRestrict=function(t,n){return n&&e.REGEX.PASSWORD.test(n)?!0:!1}}}}]),e.directive("passwordConfirm",function(){return{require:"ngModel",scope:{passwordModel:"=passwordModel"},link:function(e,t,n,i){var r=!0;e.$watch(function(){var t;return(e.passwordModel||i.$viewValue)&&(t=e.passwordModel+"_"+i.$viewValue),t},function(t){r&&(r=!1,i.$setValidity("passwordConfirm",!0)),t&&(e.passwordModel!==i.$viewValue?i.$setValidity("passwordConfirm",!1):i.$setValidity("passwordConfirm",!0))})}}}),e.directive("vmCreateKeypairValidator",function(){return{require:"ngModel",link:function(e,t,n,i){i.$validators.keypairIsNullRestrict=function(e,t){return t?!0:!1},i.$validators.keypairValueRestrict=function(e,t){return t&&t.value?!0:!1}}}}),e.directive("numericInput",function(){var e=10,t=1;return{restrict:"AE",scope:{externalModel:"=numericModel",max:"=numericMax",min:"=numericMin"},link:function(n,i,r){n.model=n.externalModel,void 0===n.max&&(n.max=e),void 0===n.min&&(n.min=t),n.up=function(){++n.model>n.max&&--n.model},n.down=function(){--n.model<n.min&&++n.model},n.$watch("model",function(e){if(isNaN(e))n.model=n.min;else{var t=Number(e);t>n.max?n.model=n.max:t<n.min?n.model=n.min:n.model=t}n.externalModel=n.model})},templateUrl:"/static/apps/common/directives/numeric-input/template.html"}}),e.directive("leSelect",["$document",function(e){return{restrict:"AE",scope:{model:"=selectModel",options:"=selectOptions",externalEmptyText:"@selectEmptyText"},link:function(t,n,i){t.emptyText=t.externalEmptyText?t.externalEmptyText:"暂无数据",t.toggleSelect=function(n){t.isOpen||(t.isOpen=!0,n.stopPropagation(),e.bind("click",r))},t.selectOption=function(e){t.model=e};var r=function(n){t.isOpen&&(e.unbind("click",r),t.isOpen=!1,t.$$phase||t.$apply())}},templateUrl:"/static/apps/common/directives/le-select/template.html"}}]),e.directive("leSlider",["Utility",function(e){return{restrict:"AE",scope:{externalModel:"=leSliderModel",step:"@leSliderStep",min:"=leSliderMin",isMinChangeable:"@isSliderMinChangeable",max:"@leSliderMax",unit:"@leSliderUnit"},link:function(t,n,i){var r=e.delayQueueModel(),o=Number(t.max),a=Number(t.min);"true"===t.isMinChangeable&&t.$watch("min",function(e){a=Number(e),t.model=a}),t.$watch("externalModel",function(e){t.model=e}),t.$watch("model",function(n){null===n||isNaN(n)?t.model=a:(e.isInt(n)||(n=Math.floor(n)),o>=n&&n>=a?(n%t.step!==0&&(n=Math.ceil(n/t.step)*t.step),r(n,function(e){t.model=Number(e),t.externalModel=t.model})):n>o?t.model=o:a>n&&(t.model=a))})},templateUrl:"/static/apps/common/directives/le-slider/template.html"}}]),e.directive("buyPeriodSelector",function(){return{restrict:"AE",scope:{selectedBuyPeriod:"=buyPeriodModel",allBuyPeriods:"=buyPeriodOptions"},link:function(e,t,n){e.selectBuyPeriod=function(t){e.selectedBuyPeriod=t},e.isSelectedBuyPeriod=function(t){return e.selectedBuyPeriod===t}},templateUrl:"/static/apps/common/directives/buy-period-selector/template.html"}}),e.directive("leAutoFocus",["$timeout",function(e){return{restrict:"AE",link:function(t,n,i){n&&n[0]&&e(function(){n[0].focus()})}}}]),e.directive("inputValidationTooltip",function(){return{restrict:"AE",scope:{message:"@validationMessage"},link:function(e,t,n){},templateUrl:"/static/apps/common/directives/input-validation-tooltip/template.html"}})}),define("../common/filters/common.filter",["angular"],function(e){return e.module("common.filter",[])}),define("../common/filters/filters",["./common.filter"],function(e){e.filter("propsFilter",function(){return function(e,t){var n=[];return angular.isArray(e)?e.forEach(function(e){for(var i=!1,r=Object.keys(t),o=0;o<r.length;o++){var a=r[o],s=t[a].toLowerCase();if(-1!==e[a].toString().toLowerCase().indexOf(s)){i=!0;break}}i&&n.push(e)}):n=e,n}}),e.filter("mclusterTypeFilter",function(){return function(e){var t="";return t=e?"后台创建":"系统创建"}}),e.filter("vmStatusFilter",["Config",function(e){var t=e.vmStatuses,n=e.vmTaskStatuses;return function(e){var i="",r=e.vmState,o=e.taskState;return i=o?n[o]?n[o]:o:t[r]?t[r]:r}}]),e.filter("diskStatusFilter",["Config",function(e){
var t=e.vmDiskStatuses;return function(e){for(var n="",i=0,r=t.length;r>i;i++)if(t[i].value==e){n=t[i].text;break}return n||"未知"}}]),e.filter("vpcStatusFilter",["Config",function(e){var t=e.vmVpcStatuses;return function(e){for(var n="",i=0,r=t.length;r>i;i++)if(t[i].value==e){n=t[i].text;break}return n||"未知"}}]),e.filter("vpcSubnetsFilter",["Config",function(e){return function(t){return t.map(function(e){return e.name}).join(", ")||e.EMPTY_TEXT}}]),e.filter("buyPeriodFilter",[function(){return function(e,t){var n=null;return n=9>=e?t?e+"个月":e:parseInt(e/12)+"年"}}]),e.filter("publicNetworkGatewayFilter",[function(){return function(e){var t="";return t="true"==e?"开启":"关闭"}}]),e.filter("vmFlavorFilter",[function(){return function(e){var t=0;return e.volumes&&e.volumes.length&&(t=e.volumes.length>1?e.volumes.map(function(e){return e.size}).reduce(function(e,t){return e+t}):e.volumes[0].size),[e.flavor.vcpus+"核",Math.ceil(e.flavor.ram/1024)+"G",t+"G"].join("/")}}]),e.filter("sideMenuUrlFilter",[function(){return function(e){var t="";return t=e["abstract"]?"javascript:void(0);":e.isSpaUrl?"#"+e.url:e.url,t||"未知"}}]),e.filter("vmFloatIpFilter",["Config",function(e){var t=e.vmFloatIpStatuses;return function(e){var n="";return n=t[e],n||"未知"}}]),e.filter("routerSubnetFilter",[function(){return function(e){var t="";if(null==e[0])return"--";for(var n=0,i=e.length;i>n;n++)t=""!==t?t+","+e[n].name:e[n].name;return t}}]),e.filter("routerGatewayFilter",[function(){return function(e){return e===!0?"开启":"关闭"}}]),e.filter("routerStatusFilter",[function(){return function(e){var t="";return t="ACTIVE"===e?"活跃":"DOWN"===e?"关闭":"BUILD"===e?"构建中":"ERROR"===e?"错误":"UNRECOGNIZED"===e?"未识别":"未知"}}]),e.filter("vmImageStatusFilter",["Config",function(e){var t=e.vmImageStatuses;return function(e){for(var n="",i=0,r=t.length;r>i;i++)if(t[i].value==e){n=t[i].text;break}return n||"未知"}}]),e.filter("vmImageSizeFilter",[function(){return function(e){var t="";return t=e/1073741824>=1?(e/1073741824).toFixed(2)+"GB":e/1048576>=1?(e/1048576).toFixed(2)+"MB":e/1024>=1?(e/1024).toFixed(2)+"KB":e+"B"}}])}),define("app",["angular","controllers/controllers","../common/services/services","../common/directives/directives","../common/filters/filters"],function(e){var t=e.module("myApp",["ngAnimate","ngRoute","ui.bootstrap","toaster","rzModule","app.controller","common.service","common.directive","common.filter"]);return t.config(["$httpProvider",function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",e.defaults.headers.post.Accept="application/json, text/javascript, */*; q=0.01",e.defaults.headers.post["Accept-Language"]="zh-CN,zh;q=0.8,en;q=0.6",e.defaults.headers.post["X-Requested-With"]="XMLHttpRequest",e.defaults.headers.get["X-Requested-With"]="XMLHttpRequest",e.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",e.defaults.transformRequest=function(e){return void 0===e?e:$.param(e)}}]),t.run(["$route","$rootScope","$http","$location","routes","Config",function(e,t,n,i,r,o){t.REGEX_MESSAGE=o.REGEX_MESSAGE,t.EMPTY_TEXT=o.EMPTY_TEXT}]),t}),define("app.router",["app"],function(e){"use strict";var t=function(e,t){var n=function(t){e.when(t.url,t.config)};angular.forEach(t,function(e,t){n(e)}),e.otherwise({redirectTo:"/vm"})},n=function(){return[{url:"/vm",title:"云主机",config:{templateUrl:"/static/apps/cloudvm/views/virtual-machine.html"}},{url:"/vm-disk",title:"云硬盘",config:{templateUrl:"/static/apps/cloudvm/views/vm-disk.html"}},{url:"/vm-vpc",title:"私有网络",config:{templateUrl:"/static/apps/cloudvm/views/vm-vpc.html"}},{url:"/vm-router",title:"路由器",config:{templateUrl:"/static/apps/cloudvm/views/vm-router.html"}},{url:"/vm-floatIP",title:"公网IP",config:{templateUrl:"/static/apps/cloudvm/views/vm-floatIP.html"}},{url:"/vm-snapshot",title:"快照",config:{templateUrl:"/static/apps/cloudvm/views/vm-snapshot.html"}},{url:"/vm-image",title:"镜像",config:{templateUrl:"/static/apps/cloudvm/views/vm-image.html"}},{url:"/vm-keypair",title:"密钥",config:{templateUrl:"/static/apps/cloudvm/views/vm-keypair.html"}}]};e.constant("routes",n()),e.config(["$routeProvider","routes",t])}),require.config({paths:{jquery:"../../javascripts/dist/jquery.min",bootstrap:"../../javascripts/dist/bootstrap.min",angular:"../../javascripts/dist/angular-package.min",common:"../../javascripts/common",browserCheck:"../../staticPage/js/browserCheck",app:"./app-build","app.router":"./app.route"},shim:{browserCheck:{deps:["jquery"],exports:"browserCheck"},bootstrap:{deps:["jquery"],exports:"bootstrap"},angular:{deps:["common"],exports:"angular"}}}),require(["jquery","angular","common","bootstrap","app","app.router"],function(e,t){t.bootstrap(document,["myApp"])}),define("main-build",function(){});